(function(){function y(O,U,S,V,Q){var T=U?U.ownerDocument:document;var N=T.createElement(O);if(S){for(var M in S){if(M=="style"){var X=S[M];for(var Y in X){N.style.setProperty(Y,X[Y])}}else{N[M]=S[M]}}}if(V&&O=="script"){var P=false;var W=function(){if(P){return}P=true;V()};N.onload=W;N.onreadystatechange=function(){if(this.readyState=="loaded"){W()}}}if(U){try{U.insertBefore(N,Q)}catch(R){U.insertBefore(N)}}return N}function s(){var M={};(location.search||"").replace(/([^=^&^?]+)=([^&]*)/g,function(P,O,N){M[O]=N});return M}function u(Q,O,P){var M=function(T,R,S){T[S]=function(){return R[S].apply(R,arguments)}};for(var N in P){M(Q,O,P[N])}}function d(M){if(!M){return M}var O=M.length,Q=[],P={};while(O--){var N=M[O];if(!P[N]){P[N]=true;Q.push(N)}}return Q}function q(O,N){O=O||{};for(var M in N){O[M]=N[M]}return O}function z(O,M){var N=O.className;M=N!==""?" "+M:M;O.className+=M}function E(M){if(M.trim){return M.trim()}else{return M.replace(/^\s+|\s+$/g,"")}}var K=function(){function N(){if(/http:\/\/.+\.(loc)\.flyapps\.me\//.test(location.href)||/http:\/\/loc\.flyapps\.me\//.test(location.href)||/http:\/\/.+test\.flyapps\.me\//.test(location.href)){return D.DEBUG}else{if(/http:\/\/.+\.(stg|test)\.flyapps\.me\//.test(location.href)){return D.INFO}else{if(/http:\/\/.+\.flyapps\.me\//.test(location.href)){return D.ERROR}}}return D.DEBUG}function M(){var O=s()["doatloggeroutput"];if(O){switch(O){case"console":return D.consoleLogger;break;case"inline":return D.writeLogger;break;case"alert":return D.alertLogger;break;case"popup":return D.popupLogger;break;default:if(window[O]){return window[O]}}}return D.consoleLogger}return new D(N(),M())};function x(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var O=arguments[0],N=arguments[1],M=arguments[2];if(typeof O.addEventListener!=="undefined"){O.addEventListener(N,M,false)}else{if(O.attachEvent){O.attachEvent("on"+N,M,false)}}}function l(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var O=arguments[0],N=arguments[1],M=arguments[2];if(typeof O.removeEventListener!=="undefined"){O.removeEventListener(N,M,false)}else{if(O.detachEvent){O.detachEvent("on"+N,M)}}}var A=function(M,O){var N;for(N in O){if(typeof(M[N])=="undefined"){return false}}for(N in O){if(O[N]){switch(typeof(O[N])){case"object":if(!O[N].equals(M[N])){return false}break;case"function":if(typeof(M[N])=="undefined"||(N!="equals"&&O[N].toString()!=M[N].toString())){return false}break;default:if(O[N]!=M[N]){return false}}}else{if(M[N]){return false}}}for(N in M){if(typeof(O[N])=="undefined"){return false}}return true};function J(){var P=[],M={},N=function(){return{error:"OK"}};this.bind=S;this.unbind=T;this.trigger=O;this.attach=R;this.setAuthFunc=Q;x(window,"message",U);function U(V){var aa=N(V);if(aa.error==="OK"){var Z=JSON.parse(V.data);Z=q(Z,aa.attachData);var X=P[Z.msnEventType];if(X){var ac={source:V.source,type:Z.msnEventType};delete Z.msnEventType;var ab=Z;for(var W=0;W<X.length;W++){var Y=X[W];Y(ac,ab)}}}}function S(X,Z){X=(X instanceof Array)?X:[X];for(var V in X){var Y=X[V];var W=P[Y];if(!W){P[Y]=W=[]}W.push(Z)}}function T(X,Y){if(!Y){P[X]=null}else{for(var V=P[X],W=V?V.length-1:-1;W>=0;--W){if(V[W]===Y){V.splice(W,1);return}}}}function O(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=window.parent}var W=arguments[0];var V=arguments[2]||{};V.msnEventType=arguments[1];V=q(V,M);W.postMessage(JSON.stringify(V),"*")}function R(V){M=V}function Q(V){N=V}}function m(V,T){var R=a.Log||new K();var P=new H();P.load(R);if(T){var N=new o();N.load(R)}V.bind([a.Events.USER_ACTION,a.Events.PAGE_VIEW],U);V.bind([a.Events.WINDOW_LOADED,a.Events.RENDER_END],Q);V.bind(a.Events.NO_RESULTS,M);V.bind([a.Events.RENDER_END,a.Events.NO_RESULTS],function(W,X){V.unbind(a.Events.RENDER_END,Q);if(N){N.report(W.type)}});V.bind(a.Events.SEARCH_ERROR,S);function M(W,X){P.report(["_trackEvent","Tracing",W.type,X.query])}function S(W,X){R.error("Error getting search results "+JSON.stringify(X));M(W,X)}function U(W,Z){var Y;switch(Z.action){case"Navigate":Y="/"+Z.to;Y+=(Z.title)?"/"+Z.title.replace("/","-"):"";break;case"Search":case"PageView":var X=Z.newQuery||Z.query;Z.page=Z.page||"search";Y="/"+Z.page;Y+=(X)?"/"+X.replace("/","-"):"";break;default:return false}P.report(["_trackPageview",Y]);return true}function Q(W){var X=-1;if(typeof doat_ts!=="undefined"){X=new Date().getTime()-doat_ts}P.report(["_trackEvent","Tracing",W.type,O(X),X])}function O(X){var W;for(W=0;W<=5;W++){if(X/1000<W){return"under "+W+" sec"}}return"over "+(W-1)+" sec"}}function H(){var M,O,N;if(/loc\.flyapps\.me/.test(location.host)){M="UA-16876190-2";O=".loc.flyapps.me"}else{if(/test\.flyapps\.me/.test(location.host)){M="UA-16876190-8";O=".test.flyapps.me"}else{if(/stg\.flyapps\.me/.test(location.host)){M="UA-16876190-7";O=".stg.flyapps.me"}else{if(/flyapps\.me/.test(location.host)){M="UA-16876190-4";O=".flyapps.me"}}}}this.report=function(Q){try{_gaq.push(Q);var R=(!_gaq.length)?"GA object":"temp array";N.info("Pushed event to _gaq ("+R+") -> "+JSON.stringify(Q))}catch(P){N.error("An error occured when performing _gaq.push ("+JSON.stringify(Q)+")")}};this.load=function(Q){N=Q;var P=(typeof doat_appName=="undefined")?location.host.split(".")[0]:doat_appName;_gaq=(typeof _gaq!=="undefined")?_gaq:[];_gaq.push(["_setAccount",M],["_setDomainName",O],["_setCustomVar",1,"appname",P]);N.info('Loading GA for account "'+M+'" under domain "'+O+'" with appname "'+P+'"');y("script",document.getElementsByTagName("HEAD")[0],{type:"text/javascript",src:(("https:"==document.location.protocol)?"https://ssl.":"http://www.")+"google-analytics.com/ga.js",async:"true"})}}function o(){var M;this.load=function(N){M=N};this.report=function(O,P){var N="doatJS://report/"+O;M.info('Reporting to native app -> "'+N+'"')}}function D(R,N,P){var Q=D.WARN;var O=D.writeLogger;var M=false;this._isMobileBrowser=D.isMobileBrowser();this.setPrefix=function(S){if(S!="undefined"){M=S}else{M=false}};this.setLogger=function(U){if(U!="undefined"){O=U}if(U===D.writeLogger){var T=document.createElement("div");T.id="logger";T.style.backgroundColor="white";T.style.position="fixed";T.style.top="100px";T.style.left="0";T.style.zIndex="20";T.style.overflow="scroll";T.style.height="400px";document.body.appendChild(T);var S=document.createElement("a");S.innerHTML="clear";S.href="javascript://";S.addEventListener("click",function(){loggerList.innerHTML=""},false);T.appendChild(S);loggerList=document.createElement("ul");T.appendChild(loggerList)}};this.setLevel=function(S){if(S!="undefined"&&typeof S=="number"){Q=S}else{if(S!="undefined"){if(S=="debug"){Q=D.DEBUG}else{if(S=="info"){Q=D.INFO}else{if(S=="error"){Q=D.ERROR}else{if(S=="fatal"){Q=D.FATAL}else{if(S=="warn"){Q=D.WARN}else{Q=D.NONE}}}}}}}};this.getPrefix=function(){return M};this.getLogger=function(){return O};this.getLevel=function(){return Q};if(R!="undefined"){this.setLevel(R)}if(N!="undefined"){this.setLogger(N)}if(P!="undefined"){this.setPrefix(P)}}D.prototype.debug=function(){if(this.getLevel()<=D.DEBUG){this._log("DEBUG",this,arguments)}};D.prototype.info=function(){if(this.getLevel()<=D.INFO){this._log("INFO",this,arguments)}};D.prototype.warn=function(){if(this.getLevel()<=D.WARN){this._log("WARN",this,arguments)}};D.prototype.error=function(){if(this.getLevel()<=D.ERROR){this._log("ERROR",this,arguments)}};D.prototype.fatal=function(){if(this.getLevel()<=D.FATAL){this._log("FATAL",this,arguments)}};D.prototype._log=function(N,T,M){var P=new Date();var V="";V+=((P.getHours()<10)?"0"+P.getHours():P.getHours());V+=":"+((P.getMinutes()<10)?"0"+P.getMinutes():P.getMinutes());V+=":"+((P.getSeconds()<10)?"0"+P.getSeconds():P.getSeconds());V+="."+((P.getMilliseconds()<100)?((P.getMilliseconds()<10)?"00"+P.getMilliseconds():"0"+P.getMilliseconds()):P.getMilliseconds());var O=[],Q="("+V+")";if(this._isMobileBrowser){var R=Q+" ";for(var S=0,U=M.length;S<U;S++){R+=" "+M[S]}O=[R]}else{O=["("+V+")"];for(S in M){O.push(M[S])}}this.getLogger()(N,T,O)};D.DEBUG=1;D.INFO=2;D.WARN=3;D.ERROR=4;D.FATAL=5;D.NONE=6;D.alertLogger=function(O,N,M){alert(O+" - "+M.join(" "))};D.writeLogger=function(Q,P,N){var M=document.createElement("li");M.innerHTML=Q+"&nbsp;:&nbsp;"+N.join(" ");var O=loggerList.getElementsByTagName("li")[0];loggerList.insertBefore(M,O)};D.consoleLogger=function(P,O,N){if(window.console){try{window.console[P.toLowerCase()].apply(window.console,N)}catch(M){try{window.console[P.toLowerCase()](N)}catch(M){window.console.log(P+":"+N)}}}};D.popupLogger=function(T,Q,O){var S=O.join(" ");if(Q.popupBlocker){return}if(!Q._window||!Q._window.document){Q._window=window.open("","logger_popup_window","width=420,height=320,scrollbars=1,status=0,toolbars=0,resizable=1");if(!Q._window){Q.popupBlocker=true;alert("You have a popup window manager blocking the log4js log popup display.\n\nThis must be disabled to properly see logged events.");return}if(!Q._window.document.getElementById("loggerTable")){Q._window.document.writeln("<table width='100%' id='loggerTable'><tr><th align='left'>Level</th><th width='100%' colspan='2' align='left'>Message</th></tr></table>");Q._window.document.close()}}var P=Q._window.document.getElementById("loggerTable");var R=P.insertRow(-1);var N=R.insertCell(-1);var M=R.insertCell(-1);N.style.fontSize="8pt";M.style.fontSize="8pt";M.style.whiteSpace="nowrap";M.style.width="100%";if(P.rows.length%2==0){N.style.backgroundColor="#eeeeee";M.style.backgroundColor="#eeeeee"}N.innerHTML=T;M.innerHTML=S};D.dumpObject=function(Q,M){if(!M){M=""}if(M.length>20){return}var O="{\n";for(var P in Q){O+=M+P+":";var N=typeof(Q[P]);N=N.toLowerCase();if(N=="object"){O+=D.dumpObject(Q[P],M+"----")}else{O+=Q[P]}O+="\n"}O+=M+"}";return O};D.isMobileBrowser=function(N){!N&&(N=navigator.userAgent);N=N.toLowerCase();var M=/(iphone|ipad|android|symbian|webos|windows phone os)/.exec(N)||[];return M[1]};var t=function(){var S=this,O=navigator,Q="everything",P="extractor",N="extractor_config",R="sites",M;this.init=function(){var T=window[N]=window[N]||{};M=T[R]=T[R]||[]};this.set=function(U){!(U instanceof Array)&&(U=[U]);for(var T=0;T<U.length;T++){M.push(U[T])}};this.getItems=function(){var T=O[Q][P].getItems?O[Q][P].getItems():"NOT IMPLEMENTED";return T};S.init()};function f(){var P="http://doatresizer.appspot.com/?url={src}&width={width}&height={height}&cache=short&crop={crop}&default={default}",O={searchbar:{type:"replace",html:'<form id="tml-searchbar-form" onsubmit="TouchyJS.Searchbar.submitFunc({onsubmit}); return false;" ><input type="text" data-defaulttext="{defaulttext}" onfocus="TouchyJS.Searchbar.clearValue(\'{defaulttext}\')" onblur="TouchyJS.Searchbar.fillValue(\'{defaulttext}\')" id="tml-searchbar-searchfield" name="searchfield" style="{style}" data-clearbutton={clearbutton}/></form>'},searcharea:{type:"replace",html:'<form id="tml-searchbar-form" onsubmit="TouchyJS.Searchbar.submitFunc({onsubmit}); return false;" ><textarea onfocus="TouchyJS.Searchbar.clearValue(\'{defaulttext}\')" onblur="TouchyJS.Searchbar.fillValue(\'{defaulttext}\')" id="tml-searchbar-searchfield" name="searchfield" style="{style}" clearbutton={clearbutton}>{defaulttext}</textarea></form>'},navigate:{type:"replace",html:'<a href="javascript://" class="{class}" onclick="TouchyJS.Navigation.goTo(\'{to}\')"><span>{label}</span></a>'},image:{type:"image",html:'<img src="'+P+'" alt="{alt}" />'}},R="tml",S={autoinit:"false"};var Q=/\{([^}]*)\}/g;var M=function(U,V){var T={};return V?(""+V).replace(Q,function(W,X){if(!T.hasOwnProperty(X)){T[X]=U.getAttribute(X)?U.getAttribute(X):S.hasOwnProperty(X)?S[X]:""}return T[X]}):V};var N=function(T,V){if($(T).replaceWith){$(T).replaceWith($(V))}else{var U=$(V)[0];T.parentNode.replaceChild(U,T)}};this.parse=function(U){!U&&(U=document.body);for(var X in O){if(O.hasOwnProperty(X)){var T=R+":"+X;var W=U.getElementsByTagName(T);for(var V=0;V<W.length;V++){var Y=M(W[V],O[X].html);N(W[V],Y);V--}}}};this.getImage=function(T){var U=new function(V){this.getAttribute=function(W){return V[W]}}(T);return M(U,P)}}function L(R){var V=this,U,S,N=R&&R.isTouch||("ontouchstart" in window);var O=function(Y){Y=(Y||navigator.userAgent).toLowerCase();U={};U.platform=T(Y);U.browser=P(Y);U.os=X(Y);U.orientation=Q.getNew();U.screen=M.get(Y);U.connection=W.get()};var T=function(aa){var ab="",Z="",Y;Y=/(iphone|ipad)|(android|htc_)|(symbian)|(webos)|(blackberry|playbook|windows phone os)|(mobile;)/.exec(aa)||[,"desktop"];ab=Y[1]||Y[2]&&"android"||Y[3]&&"nokia"||Y[4]&&"hp"||Y[5]&&""||Y[6]&&"mozilla";return{name:ab,version:Z}};var X=function(aa){var ab="",Z="",Y;Y=/(iphone|ipad)|(android|htc_)|(symbian|webos)|(blackberry|playbook)|(windows phone os)|(mobile;)/.exec(aa)||[];ab=Y[1]&&"ios"||Y[2]&&"android"||Y[3]||Y[4]&&"blackberry"||Y[5]&&"windowsphoneos"||Y[6]&&"firefoxos";if(!ab){Y=/(Win32)|(Linux)|(MacIntel)/.exec(navigator.platform)||[];ab=Y[1]&&"windows"||Y[2]||Y[3]&&"mac"||""}switch(ab){case"ios":Z=/os\s([\d_]+)\slike/.exec(aa);Z=Z[1].replace(/_/g,".");break;case"android":Z=/android\s([\d\.\-]+)[^;]*;/.exec(aa);Z=Z&&Z[1]&&Z[1].replace(/-/g,"");break}return{name:ab,version:Z}};var P=function(aa){var ab,Z="",Y;aa=aa.toLowerCase();Y=/(webkit)(?:[\/]|.+fbforiphone)/.exec(aa)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(aa)||/(msie) ([\w.]+)/.exec(aa)||aa.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(aa)||[];ab=Y[1]||"";return{name:ab,version:Z}};this.getScreen=function(){return M.get()};this.setScreen=function(Y){return M.set(Y)};this.clearScreen=function(Y){return M.clear(Y)};this.setOrientation=function(Y){Q.set(Y)};this.isTouch=function(){return N};this.isMobile=function(Z){var Y=V.getInfo(Z).platform.name;return R&&R.isTouch||/^(iphone|ipad|android|nokia|blackberry)$/.test(Y)};this.isRetina=function(){return window.devicePixelRatio>1};this.getInfo=function(){if(arguments[0]||!U){var Y=(arguments[0]===true)?undefined:arguments[0];O(Y)}return U};this.addEventListener=function(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var Y=arguments[0],af=arguments[1],aa=arguments[2],ad=N?"touchstart":"mousedown",ae=N?"touchmove":"mousemove",ag=N?"touchend":"mouseup";switch(af){case"orientationchange":Q.onOrientationChange(aa);break;case"swipeX":x(Y,"swipeX",aa);break;case"touch":var ac,ab,Z=false;x(Y,ad,function(ah){ah=ah.originalEvent||ah;ac={type:"start",position:{x:ah.touches?ah.touches[0].pageX:ah.clientX,y:ah.touches?ah.touches[0].pageY:ah.clientY}};aa(ah,ac);Z=true});x(document,ae,function(ah){if(!Z){return false}ah=ah.originalEvent||ah;ab={type:"move",position:{x:ah.touches?ah.touches[0].pageX:ah.clientX,y:ah.touches?ah.touches[0].pageY:ah.clientY}};ab.delta={x:ab.position.x-ac.position.x,y:ab.position.y-ac.position.y};aa(ah,ab)});x(document,ag,function(ai){Z=false;if(!ab||ab.delta.x===0&&ab.delta.y===0){return false}ai=ai.originalEvent||ai;var ah={type:"end",position:ab.position,delta:ab.delta,swipeEvent:true,direction:(ab.delta.x>0)?"ltr":"rtl"};aa(ai,ah);ab=undefined});break}};var Q=new function(){var ah=this,Y,ag="orientation-",ae=new RegExp(ag+"[^\\s]+","g"),ad=[],ab="orientation" in window;if(window.addEventListener){window.addEventListener((ab)?"orientationchange":"resize",af,false);document.addEventListener("DOMContentLoaded",af,false)}this.set=af;this.getCurrent=function(){return Y||ah.getNew()};this.getOtherName=function(ai){return ai==="portrait"?"landscape":"portrait"};this.getNew=function(){var ai=(ab)?window.orientation:ah.getOrientationByWindowSize();return ac(ai)};this.getOrientationByWindowSize=function(){return(window.innerHeight>window.innerWidth)?0:90};this.onOrientationChange=function(ai){ad.push(ai)};function af(aj){var ai=(aj&&!(aj.type))?ac(aj):ah.getNew();if(!Y||ai.degree!==Y.degree){Y=ai;Z();aa()}}function aa(){ad.forEach(function(ai){ai(Y)})}function ac(ak){var ai,aj;if(typeof ak==="String"){ai=ak;aj=(ak=="landscape")?90:0}else{aj=ak;ai=(Math.abs(ak)==90)?"landscape":"portrait"}return{name:ai,degree:aj}}function Z(){var ai=ag+Y.name;if(Y.degree==90){ai+=" "+ag+"landscape-right"}else{if(Y.degree==-90){ai+=" "+ag+"landscape-left"}}document.body.className=document.body.className.replace(ae,"")+" "+ai}};Q.onOrientationChange(function(){U.orientation=Q.getCurrent();U.screen=M.get()});var M=new function(){var Z=this,Y;function ab(ai,af){!ai&&(ai=navigator.userAgent);ai=ai.toLowerCase();var ac=T(ai).name;var ah=X(ai).name;var ag=["","","",""];if(/^(iphone|ipod)$/.test(ac)){if(window.screen.height==568){var ae=64,ad=53;ag=[320,568-ae,568,320-ad]}else{ag=[320,416,480,267]}}else{if(ac=="desktop"){ag=[320,416,480,267]}else{if(ah=="android"){if(/nexus s/.test(ai)){ag=[320,508,508,295]}else{if(/gt-9000/.test(ai)){ag=[320,508,508,320]}else{if(/sonyericssonr800a/.test(ai)){ag=[320,544,544,320]}else{if(/htc desire s/.test(ai)){ag=[320,533,533,320]}}}}}else{if(ah=="windowsphoneos"){ag=[295,486,"",""]}}}}Y={portrait:{width:ag[0],height:ag[1]},landscape:{width:ag[2],height:ag[3]}}}function aa(ad){var ac;if(window.innerWidth<=window.outerWidth&&window.innerWidth!==Y[Q.getOtherName(ad)].width){ac=window.innerWidth}return ac}this.set=function(ae){for(var ac in ae){for(var ad in ae[ac]){Y[ac][ad]=ae[ac][ad]}}};this.get=function(ad){var ac=Q.getCurrent().name;if(ad||!Y){ab(ad)}!Y[ac].width&&(Y[ac].width=aa(ac));return Y[ac]};this.clear=function(ac){var ad={};ad[ac]={height:"",width:""};Z.set(ad)}};var W=new function(){var ad=this,Z,ab={SPEED_UNKNOWN:100,SPEED_HIGH:30,SPEED_MED:20,SPEED_LOW:10},aa=[{name:undefined,speed:ab.SPEED_UNKNOWN},{name:"etherenet",speed:ab.SPEED_HIGH},{name:"wifi",speed:ab.SPEED_HIGH},{name:"2g",speed:ab.SPEED_LOW},{name:"3g",speed:ab.SPEED_MED}];this.get=function(){return Y()};this.set=function(ae){Z=ae||(navigator.connection&&navigator.connection.type)||0;return Y()};function Y(){return ac({},ab,aa[Z])}function ac(){var af=arguments[0];for(var ah=1,ae=arguments.length;ah<ae;ah++){for(var ag in arguments[ah]){af[ag]=arguments[ah][ag]}}return af}ad.set()}}(function(){var S,O,P="doat_onLocationRetrieved_"+new Date().getTime(),M=(typeof a!="undefined"&&a&&a.Log)||new K();L.prototype.getLocation=function(ab,W){S=ab;if(!W||!W.testProps){if(W&&W.request){M.info("Specific params requested for location",W.request);var X=s(),T={},aa=false,Y=false,V=(W.request.constructor===String)?[W.request]:W.request;for(var U=0;U<V.length;U++){var Z="do_loc_"+V[U];if(X[Z]){T[V[U]]=decodeURIComponent(X[Z]);M.info("found "+Z);Y=true}else{M.info("could not find "+V[U]+" in querystring");aa=true;if(!W.allowOneFound){break}}}if(!aa||(W.allowOneFound&&Y)){M.info("found required location data in querystring");S(N(T));return true}else{M.info("Couldnt find required location data in querystring")}}if(this.isMobile()){navigator.geolocation.getCurrentPosition(function(ac){R(ac)},function(ac){S(ac)})}else{Q(null,"http://geoip.pidgets.com/")}}else{if(W&&W.testProps&&W.testProps.position){R(W.testProps.position)}}};window[P]=function(T){T=N(T);S(T)};function R(T){var U="select * from geo.places where woeid in (select place.woeid from flickr.places where lat="+T.coords.latitude+" and  lon="+T.coords.longitude+")";Q(U);O=T}function Q(X,U){if(document.getElementById("doatenvlocationdata")){var T=document.getElementById("doatenvlocationdata");T.parentNode.removeChild(T)}var Y=(U)?U+"?":"http://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(X)+"&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";Y+="&format=json&callback="+P;var V=document.getElementsByTagName("head")[0];var W=document.createElement("script");W.setAttribute("id","doatenvlocationdata");W.setAttribute("src",Y);V.appendChild(W)}function N(U){var T={};if(U){if(U.latitude&&U.longitude){U.lat=U.latitude;U.lon=U.longitude}if(U.lat&&U.lon){T.position={coords:{latitude:U.lat,longitude:U.lon}}}if(U.query){if(U.query.results&&U.query.results.place){var V=U.query.results.place;T.city=V.locality1&&V.locality1.content;T.country=V.country&&V.country.content;T.zip=V.postal&&V.postal.content}}else{if(U.country_name){T.city=U.city;T.country=U.country_name}else{q(T,U)}}}if(!T.position&&O){T.position=O;O=undefined}return T}})();var G=function(){var M=this,O={};this.addEventListener=function(R,P){var Q=O[R];if(!Q){O[R]={callbacks:[],enabled:false};Q=O[R]}Q.callbacks.push(P);if(Q.enabled&&Q.callOnce){N(P)}};this.dispatchEvent=function(T,R){var Q=O[T];if(!Q){O[T]={callbacks:[],enabled:true};Q=O[T]}else{var P=Q.callbacks.length;for(var S=0;S<P;++S){N(Q.callbacks[S])}}if(R){q(Q,R)}};var N=function(P){P()};this.ready=function(P){M.addEventListener("ready",P)};this.focused=function(P){M.addEventListener("focused",P)};this.blurred=function(P){M.addEventListener("blurred",P)};this.hidden=function(P){M.addEventListener("hidden",P)};this.visible=function(P){M.addEventListener("visible",P)};this.NO_RESULTS="no results";this.RENDER_START="render start";this.RENDER_END="render end";this.RENDER_VISIBLE_END="render visible end";this.SEARCH_START="search request";this.SEARCH_END="search response success";this.SEARCH_ERROR="search response error";this.WINDOW_LOADED="window loaded";this.DOAT_READY="doat ready";this.DOCUMENT_READY="document ready";this.USER_ACTION="user action";this.PAGE_VIEW="page view";this.ready(function(){O.ready.enabled=true});this.focused(function(){O.focused.enabled=true;O.visible.enabled=O.hidden.enabled=O.blurred.enabled=false});this.visible(function(){O.visible.enabled=true;O.focused.enabled=O.hidden.enabled=O.blurred.enabled=false});this.hidden(function(){O.hidden.enabled=true;O.focused.enabled=O.visible.enabled=O.blurred.enabled=false});this.blurred(function(){O.blurred.enabled=true;O.focused.enabled=O.visible.enabled=O.hidden.enabled=false})};(function(ap,P,W){var M="width",ab="length",ar="radius",ak="lines",ad="trail",ag="color",aC="opacity",au="speed",al="shadow",aw="style",O="height",Q="left",R="top",S="px",ae="childNodes",aB="firstChild",T="parentNode",ao="position",U="relative",am="absolute",aG="animation",ah="transform",Y="Origin",aq="Timeout",aa="coord",ay="#000",ai=aw+"Sheets",X="webkit0Moz0ms0O".split(0),aF={},aA;function aE(aI,aK){var aH=~~((aI[ab]-1)/2);for(var aJ=1;aJ<=aH;aJ++){aK(aI[aJ*2-1],aI[aJ*2])}}function az(aH){var aI=P.createElement(aH||"div");aE(arguments,function(aK,aJ){aI[aK]=aJ});return aI}function an(aH,aJ,aI){if(aI&&!aI[T]){an(aH,aI)}aH.insertBefore(aJ,aI||null);return aH}an(P.getElementsByTagName("head")[0],az(aw));var Z=P[ai][P[ai][ab]-1];function N(aM,aH){var aJ=[aC,aH,~~(aM*100)].join("-"),aI="{"+aC+":"+aM+"}",aK;if(!aF[aJ]){for(aK=0;aK<X[ab];aK++){try{Z.insertRule("@"+(X[aK]&&"-"+X[aK].toLowerCase()+"-"||"")+"keyframes "+aJ+"{0%{"+aC+":1}"+aH+"%"+aI+"to"+aI+"}",Z.cssRules[ab])}catch(aL){}}aF[aJ]=1}return aJ}function ac(aK,aL){var aJ=aK[aw],aH,aI;if(aJ[aL]!==W){return aL}aL=aL.charAt(0).toUpperCase()+aL.slice(1);for(aI=0;aI<X[ab];aI++){aH=X[aI]+aL;if(aJ[aH]!==W){return aH}}}function at(aH){aE(arguments,function(aJ,aI){aH[aw][ac(aH,aJ)||aJ]=aI});return aH}function aj(aH){aE(arguments,function(aJ,aI){if(aH[aJ]===W){aH[aJ]=aI}});return aH}var af=function af(aH){this.opts=aj(aH||{},ak,12,ad,100,ab,7,M,5,ar,10,ag,ay,aC,1/4,au,1)},V=af.prototype={spin:function(aN){var aP=this,aI=aP.el=aP[ak](aP.opts);if(aN){an(aN,at(aI,Q,~~(aN.offsetWidth/2)+S,R,~~(aN.offsetHeight/2)+S),aN[aB])}if(!aA){var aH=aP.opts,aK=0,aL=20/aH[au],aM=(1-aH[aC])/(aL*aH[ad]/100),aO=aL/aH[ak];(function aJ(){aK++;for(var aQ=aH[ak];aQ;aQ--){var aR=Math.max(1-(aK+aQ*aO)%aL*aM,aH[aC]);aP[aC](aI,aH[ak]-aQ,aR,aH)}aP[aq]=aP.el&&ap["set"+aq](aJ,50)})()}return aP},stop:function(){var aH=this,aI=aH.el;ap["clear"+aq](aH[aq]);if(aI&&aI[T]){aI[T].removeChild(aI)}aH.el=W;return aH}};V[ak]=function(aM){var aK=at(az(),ao,U),aJ=N(aM[aC],aM[ad]),aI=0,aH;function aL(aN,aO){return at(az(),ao,am,M,(aM[ab]+aM[M])+S,O,aM[M]+S,"background",aN,"boxShadow",aO,ah+Y,Q,ah,"rotate("+~~(360/aM[ak]*aI)+"deg) translate("+aM[ar]+S+",0)","borderRadius","100em")}for(;aI<aM[ak];aI++){aH=at(az(),ao,am,R,1+~(aM[M]/2)+S,ah,"translate3d(0,0,0)",aG,aJ+" "+1/aM[au]+"s linear infinite "+(1/aM[ak]/aM[au]*aI-1/aM[au])+"s");if(aM[al]){an(aH,at(aL(ay,"0 0 4px "+ay),R,2+S))}an(aK,an(aH,aL(aM[ag],"0 0 1px rgba(0,0,0,.1)")))}return aK};V[aC]=function(aI,aH,aJ){aI[ae][aH][aw][aC]=aJ};var aD="behavior",ax="url(#default#VML)",av="group0roundrect0fill0stroke".split(0);(function(){var aI=at(az(av[0]),aD,ax),aH;if(!ac(aI,ah)&&aI.adj){for(aH=0;aH<av[ab];aH++){Z.addRule(av[aH],aD+":"+ax)}V[ak]=function(){var aQ=this.opts,aO=aQ[ab]+aQ[M],aM=2*aO;function aJ(){return at(az(av[0],aa+"size",aM+" "+aM,aa+Y,-aO+" "+-aO),M,aM,O,aM)}var aN=aJ(),aP=~(aQ[ab]+aQ[ar]+aQ[M])+S,aL;function aK(aS,aR,aT){an(aN,an(at(aJ(),"rotation",360/aQ[ak]*aS+"deg",Q,~~aR),an(at(az(av[1],"arcsize",1),M,aO,O,aQ[M],Q,aQ[ar],R,-aQ[M]/2,"filter",aT),az(av[2],ag,aQ[ag],aC,aQ[aC]),az(av[3],aC,0))))}if(aQ[al]){for(aL=1;aL<=aQ[ak];aL++){aK(aL,-2,"progid:DXImage"+ah+".Microsoft.Blur(pixel"+ar+"=2,make"+al+"=1,"+al+aC+"=.3)")}}for(aL=1;aL<=aQ[ak];aL++){aK(aL)}return an(at(az(),"margin",aP+" 0 0 "+aP,ao,U),aN)};V[aC]=function(aK,aJ,aM,aL){aL=aL[al]&&aL[ak]||0;aK[aB][ae][aJ+aL][aB][aB][aC]=aM}}else{aA=ac(aI,aG)}})();ap.Spinner=af})(window,document);var C=function(){var ae=a,am="tml_",aj=ae.Env.isMobile(),af,ah,ay,R={},T={},Y,ac=true,av=false,al,aa,ak=[],ad=false,V,W;var ax=ae.Env.getInfo().browser.name||ae.Env.getInfo().browser;Y=ax==="webkit"?"-webkit-":ax==="mozilla"?"-moz-":"";var au=function(aA){aA&&(R=q(R,aA));var aB=document.querySelector(".tml_content");al=R.firstPageId||aB&&aB.id};var N=function(){var aB=arguments;var aC=(typeof aB[0]==="string")?aB[0]:aB[0].get?aB[0].get(0).getAttribute("id"):aB[0].getAttribute("id"),aE=aB[1],aD=(typeof aB[2]==="string")?aB[2].toLowerCase():"oncomplete",aA=(typeof aB[2]==="string")?aB[3]:aB[2];T[aC]=T[aC]||{};T[aC][aD]=T[aC][aD]||{};T[aC][aD][aE]=aA};var Q=function(aJ,aK,aD){!aK&&(aK=P().urlParams);if(!aJ||av){return false}av=true;var aI=(aJ.constructor===String)?$("."+am+"content#"+aJ):$(aJ);if(!aD){X(aI,aK)}if(af[0].id==aI[0].id&&af.css("display")=="block"){ap(aI,aK);return false}else{if(aK&&aK.transition=="none"){var aF={left:"0%",display:"block"};aF[Y+"transition-duration"]="0";aF[Y+"transform"]="translateX(0)";aI.css(aF);var aB={display:"none"};if("outElementStyle" in aK){for(var aE in aK.outElementStyle){aB[aE]=aK.outElementStyle[aE]}}af.css(aB);ap(aI,aK)}else{if(aK&&aK.transition=="fade"){af.css("z-index",2);if(aj){aI.css(Y+"transition-duration","0");aI.css(Y+"transform","translateX(0)")}else{aI.css("left",0)}aI.css("display","block");af.css(Y+"transition","opacity 0.5s linear").css("opacity",0);setTimeout(function(){af.css("display","none").css(Y+"transition-duration","0").css({"z-index":1,opacity:1});ap(aI,aK)},200)}else{var aH=aK&&aK.direction||ab(aI),aA=(aH==="rtl")?"100%":"-100%",aC=(aH==="rtl")?"-100%":"100%";if(aj){aI.css(Y+"transition-duration","0");aI.css(Y+"transform","translateX("+aA+")")}else{aI.css("left",aA)}aI.css("display","block");setTimeout(function(){aI.animate({left:"0%"});af.animate({left:aC},200,"ease",function(){ap(aI,aK)})},200)}}}if(!aK||aK.muteEventReport!==true){var aG={action:"Navigate",to:aI[0].id};if(aK&&aK.title){aG.title=aK.title.replace("/","-")}if(aK&&aK.id&&aK.id.replace){aG.id=aK.id.replace("/","-")}if(ae.Messenger){ae.Messenger.trigger(ae.Events.USER_ACTION,aG)}}a.Viewport.hideAddressBar();return true};var ag=function(){if(W){var aA=P().firstPage;if(aA){ar(al,{direction:"ltr"})}else{history.back()}}else{ar(ah,{muteEventReport:true})}a.Viewport.hideAddressBar()};var ar=function(aE,aD,aF){!aD&&(aD={});if(W){aE.constructor!==String&&(aE=$(aE)[0].id);var aA=P().urlParams;if(aD.url){for(var aB in aD.url){aA[aB]=aD.url[aB]}delete aD.url}aA.topage=aE;if(A(aA,az())){return false}var aH=[];for(var aB in aA){if(!(aB==="topage"&&aA[aB]===al)){var aG=(aA[aB]!==undefined)?aA[aB]:"";aH.push(aB+"="+aG)}}var aC="?"+aH.join("&");q(aD,{firstPage:false,urlParams:aA});window.history.pushState(aD,null,aC)}Q.apply(this,arguments)};var O=function(aB,aC){var aA=af.next();if(aA&&aA.hasClass("tml_content")){ar(aA,aB,aC)}};var ao=function(aA,aC){var aB=af.prev();if(aB&&aB.hasClass("tml_content")){ar(aB,aA,aC)}};var X=function(aA,aB){var aD=af[0].id,aC=aA[0].id;q(aB,{currentElement:af[0],nextElement:aA[0]});U(aB,["*","onstart","in"]);U(aB,[aC,"onstart","in"]);if(aD!=aC){U(aB,[aD,"onstart","out"])}U(aB,aB,["onStart"])};var ap=function(aA,aB){var aD=af[0].id,aC=aA[0].id;ah=af;af=aA;q(aB,{currentElement:af[0],nextElement:ah[0]});U(aB,["*","oncomplete","in"]);U(aB,[aC,"oncomplete","in"]);if(aD!=aC){ah.css("display","none");U(aB,[aD,"oncomplete","out"])}U(aB,aB,["onComplete"]);av=false};var U=function(aE,aF,aD){var aB=true;if(!aD){aD=aF;aF=T}if(!aF){return false}for(var aC=0,aA=aD.length;aC<aA;aC++){aF=aF[aD[aC]];if(!aF){aB=false;break}}aB&&aF(aE)};var ab=function(aA){var aB=aq(aA);var aC=(aB&&aB!==""&&aB!=="none")?(aB==="translateX(-100%)"):(aA.get(0).style.left==="-100%");return aC?"ltr":"rtl"};var aq=function(aB){var aA=aB.css(Y+"transform"),aC=aB[0].style[Y+"transform"];return aA&&aA!==""&&aA!=="none"?aA:aC};var Z=function(aA){if(aA.constructor===String){af=$("#"+aA)}else{af=$(aA)}!al&&(al=aA.id)};var at=function(){return af[0]};var M=function(){if(af&&ay!==af[0].offsetHeight){ay=af[0].offsetHeight;return ay}return false};var ai=function(aC){if(aC&&aC.state){var aB=aw(aC);var aA=aB.urlParams.topage||al;Q(aA,aB)}};var S=function(){var aA=az(),aD=aA.topage||al,aB={transition:"none",outElementStyle:{}};if(a.Env.isMobile()){aB.outElementStyle[Y+"transform"]="translateX(-100%)"}else{aB.outElementStyle["left"]="-100%"}var aC=P();if(!aC||aC.firstPage===undefined){aC={firstPage:true,urlParams:aA};aw({state:aC});window.history.replaceState(aC,null)}q(aB,{firstPage:true,urlParams:aA});Q(aD,aB)};var an=function(){W=true;window.addEventListener("popstate",ai,false);S()};var az=function(){var aB=s();for(var aA in aB){aB[aA]=decodeURIComponent(aB[aA])}return aB};var P=function(){var aB={};if(V){for(var aA in V){aB[aA]=V[aA]}}return aB};var aw=function(aA){return V=aA&&aA.state};return{init:au,initHistory:an,goTo:ar,next:O,previous:ao,back:ag,attachCallback:N,bind:N,setCurrent:Z,getCurrent:at,hasNewContentHeight:M,Indicator:new h(),getCurrentHistoryState:P}};function h(){var P,R,N,S={lines:10,length:7,width:3,radius:7,color:"#ffffff",speed:1.4,trail:72,shadow:true,parent:document.body},M={position:"absolute",left:"50%",top:"50%","z-index":200};var Q=function(V){var T={};for(i in S){T[i]=S[i]}for(i in V){T[i]=V[i]}var U=V.parent||$(document.body);$mainEl=U.children(".doml-progress-indicator");if($mainEl.length===0){$mainEl=$('<span class="doml-progress-indicator" />');$mainEl.css(M);U.append($mainEl)}N=$mainEl[0];R=new Spinner(T);R.spin(N)};var O=function(){$mainEl=$('<span class="doml-progress-indicator" />');$mainEl.css(M);$(document.body).append($mainEl);N=$mainEl[0];P=new Spinner(S)};this.show=function(T){if(T){Q(T)}else{if(!P){O()}P.spin(N)}};this.hide=function(){if(R){R.stop()}if(P){P.stop()}}}var c=function(V){var ai=this,R,X,af,Y,ab=[],am=[],M="tml-searchbar-keyboard-visible",ad,ae="default";this.clearValue=N;this.fillValue=T;this.setValue=P;this.getInputElement=U;this.submitFunc=O;this.blur=aj;this.focus=ac;this.onKeyboardVisible=aa;this.onKeyboardHidden=W;a.Events.ready(al);function al(){R=document.getElementById("tml-searchbar-searchfield");if(R){af=$(document.body);Y=document.getElementById("tml-searchbar-form");ai.submit=Y.onsubmit;ad=R.getAttribute("data-defaulttext");R.addEventListener("focus",S,false);R.addEventListener("blur",Z,false);R.addEventListener("touchstart",function(){a.Viewport.hideAddressBar()},false);if(V&&V.searchClearButton){ag(V)}P("");a.Nav.bind("*","in","onstart",function(ao){if(!ao||!ao.urlParams){return}var an=ao.urlParams.do_query||"";P(an)})}}function ag(an){if(U().getAttribute("data-clearbutton")!==""){X=new B();var ao=an&&an.css||{};!ao.left&&(ao.left=R.offsetWidth);buttonEl=X.init({css:ao,onClick:function(){P("",true);ac()}});var ap=U().parentNode;ap.style.position="relative";ap.appendChild(buttonEl)}}function N(){R.className="";if(!ad){return}if(Q()===ad){P("",true)}}function T(){if(!ad){return}if(Q()===""){P(ad)}}function O(an){a.Viewport.hideAddressBar();if(Q()!==""&&Q()!==ad){an&&an()}aj()}function ac(){R.focus()}function aj(){R.blur()}function aa(an){ab.push(an)}function W(an){am.push(an)}function P(ao,an){if(!an&&!ao){ao=ad||""}if(ad){R.className=ae}R.value=ah(ao)}function Q(){return ah(R.value)}function U(){return R}function ak(){a.Messenger.trigger(a.Events.USER_ACTION,{action:"Search",newQuery:Q()});aj()}function S(){a.Viewport.hideAddressBar();af.addClass(M);N();for(var ao=0,an=ab.length;ao<an;ao++){ab[ao].call(R)}}function Z(){af.removeClass(M);T();for(var ao=0,an=am.length;ao<an;ao++){am[ao].call(R)}}function ah(an){return an.replace(/\+/g," ")}this.getValue=function(){var an=Q();return an!==ad?an:""}};function B(){var N,M={position:"absolute",top:"5px",cursor:"pointer","background-color":"#BBBBBB",width:"16px",height:"16px","text-align":"center","line-height":"17px","border-radius":"8px","-webkitborder-radius":"8px","-moz-border-radius":"8px",color:"white","font-weight":"bold","font-size":"12px","font-family":"arial","text-shadow":"none",leftOffset:-19};this.init=function(O){for(i in O.css){M[i]=O.css[i]}M.left=M.left+M.leftOffset+"px";N=$("<span/>");N.addClass("tml-searchbar-clear").html("X").css(M).click(function(P){P.preventDefault();O.onClick()});return N[0]};this.show=function(){N.show()};this.hide=function(){N.hide()}}var w=function(){var ag,V,ae,ad,Z,X,af,S,W,T,N,ab,Y;this.init=function(aj){var am;if(aj&&aj.id&&document.getElementById(aj.id)){am=$("#"+aj.id)}else{return false}if(typeof a!=="undefined"){V=a.Env.isMobile();var ai=a.Env.getInfo().browser;ae=ai==="webkit"?"-webkit-":ai==="mozilla"?"-moz-":""}else{V=true}T=aj.trackWidth;Y=aj.onSelect;af=V?"touchstart":"mousedown";S=V?"touchmove":"mousemove";W=V?"touchend":"mouseup";ag=$('<div class="doml-slider" />');am.parent().append(ag);ag.append(am);var an=[];am.children().each(function(){var ao=$("<div/>");$(this).appendTo(ao);an.push(ao.html())});itemArrLength=an.length;ab=T/itemArrLength;var ah=$('<div class="wrapper">');ah.css("width",T+"px");ag.append(ah);$eventCaptureEl=$('<div class="eventCapture" />');$eventCaptureEl.css("width",T+"px");$eventCaptureEl.bind(af,Q,false);document.addEventListener(W,M,false);ah.append($eventCaptureEl);handleWrapper=new aa();var ak=handleWrapper.init();ah.append(ak);X=new P();var al=X.init(an);ak.append(al);return true};var Q=function(ai){document.addEventListener(S,R,false);var aj=ac(ai);var ah=O(aj);if(ah!==N){N=ah;X.update(N)}handleWrapper.update(aj,N);X.show()};var R=function(ai){ai.preventDefault(ai);var aj=ac(ai);if(aj<=T&&aj>=0){var ah=O(aj);if(ah!==N){N=ah;X.update(N)}handleWrapper.onTouchMove();handleWrapper.update(aj,N)}};var M=function(ah){handleWrapper.onTouchEnd();document.removeEventListener(S,R);var ai=U(N);handleWrapper.update(ai);X.hide();if(Y){Y(N)}};var O=function(ai){var ah=(ai/T)*itemArrLength;ah=parseInt(ah,10);return ah};var ac=function(ah){ah=ah.touches&&ah.touches[0]||ah.originalEvent&&ah.originalEvent.touches&&ah.originalEvent.touches[0]||ah;return ah.clientX};var U=function(ah){return ah*ab};function aa(){var ah;this.init=function(aj){ah=$('<div class="handle_wrapper"><div class="handle"/></div>');return ah};this.update=function(aj){ai(aj)};this.onTouchMove=function(){ah.addClass("dragged")};this.onTouchEnd=function(){ah.removeClass("dragged")};var ai=function(aj){ah.css(ae+"transform","translateX("+aj+"px)")}}function P(){var ai=this;var aj,ah,al,ak;this.init=function(am){ak=am;aj=$('<div class="preview"/>');ah=$('<div class="content"/>');aj.append(ah);al=$('<span class="indicator"/>');aj.append(al);ai.hide();return aj};this.show=function(){aj.addClass("displayed")};this.update=function(am){ah.html(ak[am]);al.html(am+1+" of "+ak.length)};this.hide=function(){aj.removeClass("displayed")}}};function I(){var ai=null,W=null,U=null,Y=null;var X=0,V=0,T=false,R=true,S=false;var M=320,Q=0,ac=5,af=0,O=null;var ag="0.5",N=4000;var Z=this;this.init=function(ak){ak=ak||{};ai=ak.element||null;W=ak.navElement||null;U=ak.itemsElement||null;Y=ak.onSelect||null;ak.itemWidth&&(M=ak.itemWidth);ak.thumbWidth&&(Q=ak.thumbWidth);ak.numVisibleThumbs&&(ac=ak.numVisibleThumbs);ak.animationSpeed&&(ag=ak.animationSpeed);ak.autoplay&&(typeof ak.autoplay=="number")&&(N=ak.autoplay);R=(typeof ak.stopAutoplayOnTouch=="boolean")?ak.stopAutoplayOnTouch:true;S=(typeof ak.thumbsSwipe=="boolean")?ak.thumbsSwipe:false;onHitStartArr=[],onHitEndArr=[],onHitStart=function(){onHitStartArr.forEach(function(al){al.apply(arguments)})};onHitEnd=function(){onHitEndArr.forEach(function(al){al.apply(arguments)})};ak.onHitStartCallback&&onHitStartArr.push(ak.onHitStartCallback);ak.onHitEndCallback&&onHitEndArr.push(ak.onHitEndCallback);af=U.find("li").length;aa();ab();if(W){var aj=W.find("li");aj.click(function(){Z.setItemByThumb(this)});$(aj[0]).addClass("active")}ae();if(ak.autoplay){Z.autoplayStart();if(ak.stopAutoplayOnFocus){a.Events.focused(function(){Z.autoplayStop()});a.Events.blurred(function(){Z.autoplayStart()})}}};function ab(){var aj=U.parent().get(0);a.Env.addEventListener(aj,"touch",function(al,ak){switch(ak.type){case"start":ah(U);R&&Z.autoplayStop();break;case"move":Z.move(ak.delta.x);break;case"end":if(!ak.swipeEvent){Z.showCurrentItem()}else{al=al.originalEvent||al;al.preventDefault();P(U);if(ak.direction=="rtl"){Z.next()}else{Z.prev()}}break}});if(W&&S){aj=W.parent().get(0);a.Env.addEventListener(aj,"touch",function(al,ak){switch(ak.type){case"start":ah(W);R&&Z.autoplayStop();break;case"move":Z.moveTabs(ak.delta.x);break;case"end":if(!ak.swipeEvent){Z.showCurrentItem(true)}else{al=al.originalEvent||al;al.preventDefault();P(W);if(ak.direction=="rtl"){Z.nextTabs()}else{Z.prevTabs()}}break}})}$(document).bind("keyup",function(ak){if(T){switch(ak.keyCode){case 36:R&&Z.autoplayStop();Z.setItem(0);break;case 35:R&&Z.autoplayStop();Z.setItem(af-1);break;case 39:R&&Z.autoplayStop();Z.next();break;case 37:R&&Z.autoplayStop();Z.prev();break}}})}function aa(){ad(ai);ad(W);ad(U);U.parent().css({width:M+"px",overflow:"hidden"});U.find("li").css({"float":"left",width:M+"px"});U.css({width:(M*af)+"px","list-style-type":"none",overflow:"hidden"});if(W&&Q!==0){W.css({width:(Q*af)+"px","list-style-type":"none",overflow:"hidden"})}}this.autoplayStart=function(){if(O!==null){Z.autoplayStop()}O=setInterval(function(){Z.next(true)},N)};this.autoplayStop=function(){clearInterval(O);O=null};this.show=function(aj){if(aj&&aj.delay){setTimeout(ae,aj.delay)}else{ae()}};this.hide=function(){ai.hide();T=false};function ae(){ai.show();T=true}this.removeItem=function(al){var ak=(typeof al=="number")?U.children()[al]:al;var aj=Z.index(ak);$(ak).remove();W&&$(W.children()[aj]).remove();af--;if(X==aj){X--;if(X<=0){X=0}}Z.showCurrentItem()};this.move=function(aj){U.css({"-webkit-transform":"translate("+-(X*M-aj)+"px)","-moz-transform":"translate("+-(X*M-aj)+"px)",transform:"translate("+-(X*M-aj)+"px)"})};this.moveTabs=function(aj){W&&W.css({"-webkit-transform":"translate("+-(V*Q-aj)+"px)","-moz-transform":"translate("+-(V*Q-aj)+"px)",transform:"translate("+-(V*Q-aj)+"px)"})};this.prev=function(){X--;if(X<0){X=0;onHitStart()}Z.showCurrentItem()};this.next=function(aj){X++;if(X==af){X=(aj)?0:af-1;onHitEnd()}Z.showCurrentItem()};this.prevTabs=function(){V-=ac;if(V<=0){V=0}Z.showCurrentItem(true)};this.nextTabs=function(){V+=ac;if(V>=af-ac){V=af-ac}Z.showCurrentItem(true)};this.setItemByThumb=function(aj){Z.setItem(Z.index(aj))};this.getCurrent=function(){return X};this.index=function(al){al=$(al);var aj=al.parent().children();for(var ak=0;ak<aj.length;ak++){if(aj[ak]==al[0]){return ak}}return -1};this.setItem=function(aj){X=aj;Z.showCurrentItem()};this.showCurrentItem=function(am){var al=(am&&W)?W:U;var aj=(am&&W)?-(V*Q):-(X*M);P(al);al.css({"-webkit-transform":"translate("+aj+"px)","-moz-transform":"translate("+aj+"px)",transform:"translate("+aj+"px)"});Y&&Y(X);U.find(".active").removeClass("active");$(U.children("li")[X]).addClass("active");if(W){W.find(".active").removeClass("active");$(W.children("li")[X]).addClass("active")}if(!am){var ak=Math.floor(X/ac)*ac;if(ak!=V){V=ak;Z.showCurrentItem(true)}}};function ah(aj){aj.css({"-moz-transition":"-moz-transform 0s","-webkit-transition":"-webkit-transform 0s",transition:"transform 0s"})}function P(aj){aj&&aj.css({"-moz-transition":" -moz-transform "+ag+"s ease-out","-webkit-transition":"-webkit-transform "+ag+"s ease-out",transition:"transform "+ag+"s ease-out"})}function ad(aj){aj&&aj.css({"-webkit-transform":"translate3d(0px, 0px, 0px) rotate(0deg) scale(1)","-webkit-box-sizing":"border-box","-webkit-backface-visibility":"hidden"})}}function F(){var T=this,Y,U,N,M,aa,S=[],V,ab,O=document.getElementsByTagName("head")[0],Q={vScrollbar:true,hScroll:false,useTransform:false},P;var X=function(){var ae=$("."+N);return(ae.length>0)};var Z=function(){if(ac()){Y.Log&&Y.Log.info(Y.Env.getInfo().platform+" "+Y.Env.getInfo().version+" has fixed positioning so using position: fixed");ab.css({position:"fixed",top:0,left:0,width:"100%","z-index":2});$contents.css({top:ab.get(0).offsetHeight+"px",height:"auto","z-index":1})}else{Y.Log&&Y.Log.info(Y.Env.getInfo().platform+" "+Y.Env.getInfo().version+" has NO fixed positioning so using iScroll");if(S.length==0){document.body.addEventListener("touchmove",function(ax){},false)}for(var aq=0,ar=$contents.length;aq<ar;aq++){var ae=$contents[aq];var aw=$(ae);var an=ae.getAttribute("id");if(S[an]){S[an].refresh.call(S[an])}else{if(!(P.disableIScroll&&P.disableIScroll[an])){aw.css({visibility:"hidden",display:"block"});var av={};for(k in Q){av[k]=Q[k]}var ag=$(ae).children("*");var am=ag.length===1;if(!am){var ah=document.createElement("div");ah.className=U+"created";ah.style.width="100%";for(var aq=0,ar=ae.children.length;aq<ar;aq++){alert(ae.children[aq]);ah.appendChild(ae.children[aq])}ae.appendChild(ah)}else{ag[0].style.width="100%"}if(P.pullToRefresh===an){var au="touchy-pulldown",ak="touchy-pulldown-icon",ao="touchy-pulldown-flip",al="touchy-pulldown-loading",af="touchy-pulldown-label",ap={pull:"Pull down to refresh...",release:"Release to refresh...",loading:"Loading..."};var ai="#"+au+" {     background:#000000;     height:40px;     line-height:40px;     padding:5px 10px;     font-weight:bold;     font-size:14px;     color:#888888;     visibility:hidden}#"+au+" ."+ak+" {     display:block; float:left;     width:40px; height:40px;     background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAACgCAMAAACsXRuGAAAAt1BMVEX////FxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcU7SVrkAAAAPHRSTlMAAPONxyCMRvCjM2n59gzeD/xssVo52Akwh6sDpeTbckJLZroqfhUnRernVxifG9XDgb2ZzzxjeLThEmBcLCjmAAACDklEQVR4Xu2Y124yQQyFM9sh9BJafgik956/7fs/V4RCwiITbMdjCSGfKy4On7THnuLZ8yGTyRWUr1W54NgNIC4Dbm+VrQ+tbQxoQAMa0IAGnO4vtR44WBquCcBuJadrSslwQucNaBm2qbyHEQ3YqNN4l3fUKpdpMV7Q26ZF4T3S+5AU49OIA8RjvLpxDCAeY/PIcYB4jKf8tTzcxDt2fGBt/D3v19kPgK5fRQLkAt0MCZANdIdIgGxg7WBjgHygO1kTY/NVMla8QeBvJwHCGP84CRDG+PefBAhjrHTlo9n/InDiY9a7XfLazgewd//Jqze8AN15sAiw7Gu87XwAW/7m5ec5b+j8AXsveT6uSYAwxmrf7xNBZ+aYQJPJZDLh+20aRlkWhen8twdgnCyO0SCJfQDjUv6lUuwBmOQFJXJgGhSBQSoGhvmKQnFNo1VgBD3MmmarwAx6WDWFQOhh1RR+MvSwagqLwqw7/ndW3UkfCD2bhJcAephAvJGYn4y3OrMouIfZNriH19i4h7v0cI9ww4ce4ZEEPTt6/uJ+UdS4H28G1C9qV9yPLyjUL1vyuB/dlLh+dNtE/dpA+SdrF0XeNsqNLV96+puDfPvaaukfUvJjVP+gl19F9C9L8uuc/oVTfiXWv7TLxwr9wUc+msmHR/3xVj6A6z8RSBej/jMLp+76T1X6j2m7eP6aTO9STHV4CXebKAAAAABJRU5ErkJggg%3D%3D); 0 0 no-repeat;     -webkit-background-size:40px 80px; background-size:40px 80px;     -webkit-transition-property:-webkit-transform;     -webkit-transition-duration:250ms;     -webkit-transform:rotate(0deg) translateZ(0);}#"+au+"."+ao+" ."+ak+" {     -webkit-transform:rotate(-180deg) translateZ(0);}#"+au+"."+al+" ."+ak+" {     background-position:0 100%;     -webkit-transform:rotate(0deg) translateZ(0);     -webkit-transition-duration:0ms;     -webkit-animation-name:"+al+";     -webkit-animation-duration:2s;     -webkit-animation-iteration-count:infinite;     -webkit-animation-timing-function:linear;}@-webkit-keyframes "+al+" {     from { -webkit-transform:rotate(0deg) translateZ(0); }     to { -webkit-transform:rotate(360deg) translateZ(0); }}";y("style",O,{type:"text/css",innerHTML:ai});var aj='<div id="'+au+'">    <span class="'+ak+'"></span>    <span class="'+af+'">'+ap.pull+"</span></div>";ag.prepend(aj);$pullDownElement=$("#"+au);$pullDownLabelClass=$pullDownElement.find("."+af);pullDownOffset=$pullDownElement[0].offsetHeight;var at={onRefresh:function(){$pullDownElement.css("visibility","visible");$pullDownElement.removeAttr("class");$pullDownLabelClass.html(ap.pull)},onScrollMove:function(){if(this.y>5&&!$pullDownElement.hasClass(ao)){$pullDownElement.addClass(ao);$pullDownLabelClass.html(ap.release);this.minScrollY=0}else{if(this.y<5&&$pullDownElement.hasClass(ao)){$pullDownElement.removeAttr("class");$pullDownLabelClass.html(ap.pull);this.minScrollY=-pullDownOffset}}},onScrollEnd:function(){if($pullDownElement.hasClass(ao)){$pullDownElement.removeAttr("class");$pullDownLabelClass.html(ap.loading);if(doat_config.pullToRefreshCB){doat_config.pullToRefreshCB()}S[an].refresh.call(S[an]);$pullDownElement.parent().css("-webkit-transform","translate3d(0px, -"+pullDownOffset+"px, 0px) scale(1)")}},topOffset:pullDownOffset,useTransition:true,useTransform:true};for(k in at){av[k]=at[k]}}S[an]=new iScroll(an,av);aw.bind("touchstart",{id:an},function(ax){var ay=ax.data.id;S[ay].refresh.call(S[ay])});aw.css({display:"none",visibility:"visible"})}}}}};this.init=function(ae){P=ae;V=$(document.body);Y=window.TouchyJS;U="tml_";N=U+"content";M=U+"header";aa=U+"scrollable";$contents=V.find("."+N);Y.Env.addEventListener("orientationChange",R);if($contents.length>0){R($contents);var af=P.displayContent||0,ag=$contents[af];$(ag).css("display","block");Y.Nav.setCurrent(ag)}};function W(){document.body.removeEventListener("touchstart",W);var ae=Y.Nav.getCurrent();$(ae).css("height",window.screen&&window.screen.availHeight+"px"||"1000px");window.scrollTo(0,0);setTimeout(function(){T.refreshAll()},1000)}function R(af){af=af&&af.length?af:V.children("."+N);ab=ab||V.children("."+M);var ae=ab.length?ab[0].offsetHeight:0,ag=window.innerHeight-parseInt(V.css("margin-top"),10)-parseInt(V.css("margin-bottom"),10)-ae;af.css({width:"100%",position:"absolute",top:ae+"px"});if(P.fixedPositioning){Z(P.fixedPositioning==="capableOnly")}}this.refresh=function(af,ae){af=af||Y.Nav.getCurrent().getAttribute("id");if(ae){$("#"+af).children("*").css("height",ae+"px")}if(S[af]){S[af].refresh()}};this.refreshAll=function(){R()};this.scrollTo=function(ag){var ae=Y.Nav.getCurrent(),af=ae.getAttribute("id");if(S[af]){S[af].scrollTo(0,ag,0)}else{ae.scrollTop=ag}};this.disable=function(){var ae=Y.Nav.getCurrent(),af=ae.getAttribute("id");if(S[af]){S[af].disable()}};this.enable=function(){var ae=Y.Nav.getCurrent(),af=ae.getAttribute("id");if(S[af]){S[af].enable()}};var ac=function(){if(!Y.Env.isMobile()){return true}var ae=Y.Env.getInfo();p=ae.platform,v=ae.version;if(p==="iphone"||p==="ipad"){return ad(v,"5")}else{if(p==="android"){return ad(v,"2.2")}}return false};function ad(ai,ah){var ag=ai.split(".");var af=ah.split(".");for(var ae=0;ae<ag.length;++ae){if(af.length==ae){return true}if(ag[ae]==af[ae]){continue}else{if(parseInt(ag[ae],10)>parseInt(af[ae],10)){return true}else{return false}}}if(ag.length!=af.length){return false}return true}}function g(N,T,S){S&&S.info("platform="+N);var M=document.body.style.animationName,Q=["Webkit","Moz","O","ms","Khtml"];if(!M){for(var R=0;R<Q.length;R++){if(document.body.style[Q[R]+"AnimationName"]!==undefined){CSS_PREFIX="-"+Q[R].toLowerCase()+"-";M=true;break}}}if(!M){return false}var O=["scale","rotate","skew","translate","matrix"];U();$.fn.fadeIn=function(){var X=j(arguments);return $(this).animate({opacity:1},X.dur,X.ease,X.cb)};$.fn.fadeOut=function(){var X=j(arguments);return $(this).animate({opacity:0},X.dur,X.ease,X.cb)};$.fn.animate=function(){var af=this;var aa,ad,X,Z,ac=[];for(var ab=1;ab<arguments.length;ab++){var ae=arguments[ab];if(typeof ae==="function"){ac.push(ae)}else{if(ae==="fast"||ae==="slow"){X=ae}else{if(typeof ae==="string"){Z=ae}else{X=ae}}}}ad=arguments[0];ad[CSS_PREFIX+"transform"]="";for(aa in ad){var Y;if(ad[aa].toString().indexOf("=")!==-1){ad[aa]=W(af,aa,ad[aa])}if(P(aa)){ad[CSS_PREFIX+"transform"]+=aa+"("+ad[aa]+")";delete ad[aa]}else{if(aa==="left"||aa==="right"){Y=(aa==="right")?V(ad[aa]):ad[aa];ad[CSS_PREFIX+"transform"]+="translateX("+Y+")";delete ad[aa]}else{if(aa==="bottom"||aa==="top"){Y=(aa==="bottom")?V(ad[aa]):ad[aa];ad[CSS_PREFIX+"transform"]+="translateY("+Y+")";delete ad[aa]}}}}X=(X==="fast")?0.2:(X==="slow")?0.6:X/1000||0.3;Z=(!Z||Z==="swing")?"ease-in-out":Z;if(ac.length>0){setTimeout(function(){var ah,ag=ac.length;for(ah=0;ah<ag;ah++){ac[ah].call(af)}},X*1000)}ad[CSS_PREFIX+"transition"]="all "+X+"s "+Z;return af.css(ad)};function P(X){for(var Y=0;Y<O.length;Y++){if(X.indexOf(O[Y])!==-1){return true;break}}return false}function V(X){X=X.toString();return(X.indexOf("-")===0)?X.substring(1,X.length):"-"+X}function W(Y,ab,aa){var ae=(aa.indexOf("-=")!==-1)?-1:1;aa=aa.toString();var X=parseInt(aa.substring(2,aa.length),10).toString();var Z=aa.substring(2+X.length,aa.length);var ad=Y.css(ab);ad=(ad&&ad!=="")?parseInt(ad,10):0;var ac=ad+(ae*X)+Z;return ac}function U(){var X={};if(N!=="android"){X[CSS_PREFIX+"transform"]="translate3d(0px, 0px, 0px) rotate(0deg) scale(1)";X[CSS_PREFIX+"box-sizing"]="border-box";X[CSS_PREFIX+"backface-visibility"]="hidden";S&&S.info("Including cfg['"+CSS_PREFIX+"transform'] = 'translate3d(0px, 0px, 0px) rotate(0deg) scale(1)'")}else{S&&S.info("not including cfg['"+CSS_PREFIX+"transform'] = 'translate3d(0px, 0px, 0px) rotate(0deg) scale(1)'")}$(".doml_content").css(X)}}function j(N){var P={};for(var O=0;O<N.length;O++){var M=N[O];if(typeof M==="function"){P.cb=M}else{if(M==="fast"||M==="slow"){P.dur=M}else{if(typeof M==="string"){P.ease=M}else{P.dur=M}}}}return P}var e=function(){var aj=this,S={},Y=document.getElementsByTagName("head")[0],ai=$(document.body),av=null,ag=null,T=null,N=null,ak=null,aa=false,U=textConnect=textConnecting=null,O=null;var al=false,ao=null,an=[];var ad=null,aq=null,ah="isFBUser",X="",ac=1,au=2,at="doml-facebook",V="doml-facebook-loggedin";var af={textDialog:"Welcome<br />Please login",textConnect:"Login with Facebook",textConnecting:"Connecting..."};this.init=function(aw,ax){aw&&(S=aw);if(al||(!ax&&!S.login&&!Q())){return}ad=S.appId;aq=S.channel||"http://"+window.location.hostname+"/channel.php";U=S.textDialog||af.textDialog;textConnect=S.textConnect||af.textConnect;textConnecting=S.textConnecting||af.textConnecting;X=S.namespace||"";W();P();$elLoginCancel=$("#doat-fb-login-cancel");av=$("#doat-fb-login");T=av.find(".button");ak=T.find(".button-loading");N=T.find(".button-real");av.find(".content").html(U);N.find(".text").html(textConnect);ak.find(".text").html(textConnecting);T.bind("touchstart",function(ay){ay.preventDefault();ay.stopPropagation();aj.login()});ag=$('<div id="doat-fb-overlay"></div>');ai.append(ag);ag.bind("touchstart",function(ay){ay.preventDefault();ay.stopPropagation()});ai.addClass(at);if(S.permissions){O=S.permissions}R();ap();al=true};this.forceInit=function(){aj.init(null,true)};function R(){if(ar.get(ah)!=au){$(document.body).addClass("loggedout");T.find(".button-loading").removeClass("active");T.find(".button-real").addClass("active");ag&&ag.show();av.show();var ay=document.body.scrollTop||document.documentElement.scrollTop;var ax=window.innerHeight/2+ay;av.css({top:ax+"px","margin-top":-(av.height()/2+20)+"px"});av.bind("touchstart",function(az){az.preventDefault()});if(Spinner){var aw={lines:8,length:2,width:3,radius:3,color:"#fff",speed:1,trail:60,shadow:false};loading=new Spinner(aw).spin(ak.find(".icon")[0])}}}function ap(){var ay=$('<div id="fb-root"></div>');ai.append(ay);var az=document,ax,aA="facebook-jssdk",aw=az.getElementsByTagName("script")[0];ax=az.createElement("script");ax.id=aA;ax.async=true;ax.src="//connect.facebook.net/en_US/all.js";aw.parentNode.insertBefore(ax,aw)}this.onFBInit=function(){FB.init({appId:ad,channelUrl:aq,status:true,cookie:true,xfbml:false});FB.getLoginStatus(function(aw){aa=aw.status==="connected";if(aw.status==="connected"){M(O,ae,function(){aj.login()})}else{aj.showLogin()}})};window.fbAsyncInit=aj.onFBInit;this.showLogin=function(){ar.set(ah,ac);R();FB.Event.subscribe("auth.statusChange",function(aw){aa=aw.status==="connected";if(aa){ae()}else{Z()}})};this.hideLogin=function(){av.hide();ag&&ag.hide();$(document.body).removeClass("loggedout");aa=true};this.login=function(){if(!al){aj.forceInit();return}if(!ar.get(ah)){ar.set(ah,ac)}FB.login(function(aw){if(aw.status!=="connected"){Z()}else{ae()}},(O?{scope:O}:null))};this.logout=function(){};this.loggedIn=function(){return aa};this.action=function(aw){var ay=aw.fb.namespace||X;var az=null;var ax=new am();ax.init(aw.fb.shortname);for(key in aw.fb.data){aw.fb.data[key]=ax.addToLink(aw.fb.data[key])}FB.api("/me/"+ay+":"+aw.fb.action,"post",aw.fb.data,function(aA){ax.handleAPICallback(aw,aA)})};this.share=function(aw){if(!aw||!aw.fb||!aw.app){return}if(!al){aj.onLogin(function(){aj.share(aw)});aj.forceInit();return}var ay={method:"feed",link:aw.fb.link||"http://"+window.location.hostname,message:aw.fb.message||null,picture:aw.fb.picture||null,name:aw.fb.name||null,description:aw.fb.description||null,caption:aw.fb.caption||null};var ax=new am();ax.init(aw.fb.shortname);ay.link=ax.addToLink(ay.link);FB.ui(ay,function(az){ax.handleAPICallback(aw,az)})};function am(){var ay="",aw=null,az="flyapps.me";this.init=function(aB){var aA=window.location.host.split(".");if(!aB){aB=aA[0]}aA.splice(0,1);az=aA.join(".");ay=aB+"-"+(new Date()).getTime()};this.addToLink=function(aA){if(aA){if(aA.indexOf("?")!==-1){aA+="&token="+ay}else{aA+="?token="+ay}return aA}return false};this.handleAPICallback=function(aD,aC){if(!aC||aC.error){aD.fb.onError&&aD.fb.onError()}else{aD.app.onSuccessInit&&aD.app.onSuccessInit();var aB=null;var aA=null;if(aC){aA=aC.post_id}var aE={app:{id:aD.app.app_id,name:aD.app.app_name,link:aD.app.app_link||aD.fb.link,image:aD.app.app_image||null},fb:aD.fb,post:{profile_id:null,profile_name:null,profile_image:null,message:null,created:null}};a.FB.getUser(function(aF){aD.app.getUser&&aD.app.getUser(aF);aE.post.profile_id=aF.id;aE.post.profile_name=aF.name;aE.post.profile_image="http://graph.facebook.com/"+aF.id+"/picture";if(aA){ax(aE);a.FB.getPostData(aA,function(aG){aD.app.onGetPostData&&aD.app.onGetPostData(aG);if(aG.picture){aE.app.image=decodeURIComponent(aG.picture.match(/&src=(.+)/)[1])}if(aG.message){aE.post.message=aG.message}if(aG.created){aE.post.created=aG.created}ax(aE,function(){aD.fb.onSuccess&&aD.fb.onSuccess()})},function(){aD.fb.onSuccess&&aD.fb.onSuccess()})}else{ax(aE,function(){aD.fb.onSuccess&&aD.fb.onSuccess()})}})}};function ax(aA,aB){aw&&aw.abort();aw=$.getJSON("http://developer."+az+"/facebook/updateToken.php?token="+ay+"&data="+encodeURIComponent(JSON.stringify(aA))+"&callback=?",function(aC){aB&&aB(aC)})}}this.getUser=function(aw,ax){if(ao){ab(ao,aw,ax)}else{FB.api("/me",function(ay){ab(ay,aw,ax)})}};function ab(ax,aw,ay){ao=ax;if(!ax||ax.error){ay&&ay(ax)}else{aw&&aw(ax)}}this.getPostData=function(ax,aw,ay){if(!ax){return null}FB.api(ax,"get",function(az){if(!az||az.error){ay&&ay(az)}else{aw&&aw(az)}});return true};function Q(){return ar.get(ah)}function M(ay,aw,ax){if(!ay){aw&&aw();return}var aA="select "+ay+" from permissions where uid=me()";var az=FB.Data.query(aA);az.wait(function(aB){var aD=true;var aC=new Array();aC=ay.split(",");$.each(aC,function(aE,aF){if(aB[0][aF]!=1){aD=false;return}});if(aD){aw&&aw()}else{ax&&ax()}})}this.onLogin=function(aw){an.push(aw)};function ae(){ar.set(ah,au);ai.addClass(V);aj.hideLogin();for(var aw=0;aw<an.length;aw++){an[aw]()}}function Z(){}function W(){var aw='#doat-fb-login {position: absolute;left: 50%;width: 260px;margin: 0 0 0 -150px;background: rgba(0, 0, 0, .8);padding: 20px;border-radius: 10px;color: #fff;text-shadow: 0 1px 3px rgba(0, 0, 0, .3);text-align: center;font-size: 18px;z-index: 600;display: none;}#doat-fb-login .button {position: relative;font-weight: bold;margin-top: 20px;height: 44px;line-height: 44px;font-size: 17px;border: 1px solid #2e4687;text-shadow: 0 1px 0 rgba(0, 0, 0, .5);cursor: pointer;-moz-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;-webkit-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;-ms-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;background: #485f9a;background: -moz-linear-gradient(center top, #5670ad 0, #3c4e88 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #5670ad), color-stop(1, #3c4e88));border-radius: 5px;}#doat-fb-login .button .c {position: absolute;top: 0;bottom: 0;left: 0;right: 0;padding-left: 45px;opacity: 0;pointer-events: none;-moz-transition: all .3s linear;-webkit-transition: all .3s linear;-ms-transition: all .3s linear;transition: all .3s linear;}#doat-fb-login .button .c.active {opacity: 1;pointer-events: auto;}#doat-fb-login .button .button-loading .text {opacity: .5;}#doat-fb-login .button .icon {position: absolute;top: 0;bottom: 0;left: 0;width: 45px;border-right: 1px solid #2e4687;-moz-box-shadow: -1px 1px 0 0 #8d9fc8 inset;-webkit-box-shadow: -1px 1px 0 0 #8d9fc8 inset;-ms-box-shadow: -1px 1px 0 0 #8d9fc8 inset;box-shadow: -1px 1px 0 0 #8d9fc8 inset;border-radius: 5px 0 0 5px;}#doat-fb-login .button .button-real .icon:before {content: "";position: absolute;top: 50%;left: 50%;width: 32px;height: 32px;margin: -15px 0 0 -16px;background-image:url(http://cdn0.flyapps.me/developer/facebook/fb.png);background-size: 31px 32px}#doat-fb-login-cancel {color: #ccc;cursor: pointer;font-size: 15px;margin-top: 20px;display: none;}#doat-fb-login-cancel span {text-decoration: underline;}#doat-fb-overlay {position: absolute;height: 1000px;top: 0;left: 0;right: 0;bottom: 0;background: rgba(0,0,0,.5);z-index: 500;display: none;}';y("style",Y,{innerHTML:aw})}function P(){var aw=document.createElement("div");aw.id="doat-fb-login";aw.innerHTML='<div class="content"></div><div class="button"><div class="c button-loading"><span class="icon"></span><span class="text"></span></div><div class="c button-real"><span class="icon"></span><span class="text"></span></div></div><div class="cancel" id="doat-fb-login-cancel"></div>';document.body.appendChild(aw)}var ar=new function(){this.get=function(ax){var ay=null;if("localStorage" in window){try{ay=localStorage[ax]}catch(aw){}}return ay};this.set=function(ax,ay){if(!"localStorage" in window){return false}try{localStorage[ax]=ay}catch(aw){return false}return true}}};var r=function(){var R=this,Z="Viewport",ab,S,W={},X={portrait:560,landscape:340},aa={portrait:416,landscape:250},ac,V="viewport-height",U,O=86400000,T=false;this.STORAGE="storage";this.ENV="env";this.DETECTED="detected";this.init=function(ad){ab=ad.$container;logger=ad.logger;ac=ad.Storage;U=M()||{}};this.setHeight=function(ag){var af=P();!ag&&(ag={});if(W[af]){R.hideAddressBar();setTimeout(R.hideAddressBar,1000);ag.callback&&ag.callback();return false}if(!U[af]){var ae=TouchyJS.Env.getScreen().height;if(ae){Y(ae,af,R.ENV,ag.callback);R.hideAddressBar();Q(af,ae)}else{var ad=$('<div id="viewportTestElement" style="height: 2000px; width: 100%;">&#160;</div>');ab.append(ad);R.hideAddressBar();setTimeout(function(){N(af,ag.callback)},2000)}}else{Y(U[af],af,R.STORAGE,ag.callback)}return true};this.getHeight=function(){return{value:ab.height(),source:S}};this.hideAddressBar=function(){window.setTimeout(function(){window.scrollTo(0,1)},0)};this.shouldRecalculate=function(ad){ad&&(T=ad);return T};this.getTestHeight=function(ad){return X[ad]};function P(){return a.Env.getInfo().orientation.name}function N(ae,ad){if(window.innerHeight>=aa[ae]){Y(window.innerHeight,ae,R.DETECTED,ad);Q(ae,window.innerHeight);R.hideAddressBar()}else{setTimeout(function(){N(ae,ad)},1000)}}function Q(ad,ae){}function M(){return undefined}function Y(ae,ag,aj,ad){var ah=document.createElement("style");ah.id="viewport-"+ag;var af="";af+=".orientation-"+ag+"{min-height:"+ae+"px; position: relative; top: auto; left:auto; bottom: auto; right: auto}";af+=".orientation-"+ag+" #viewportTestElement {display: none}";ah.innerHTML=af;document.getElementsByTagName("head")[0].appendChild(ah);W[ag]=true;S=aj;var ai={};ai[ag]={height:ae};a.Env.setScreen(ai);ad&&ad(aj)}};var b=function(O){var N=this,Q={resizerUrl:"http://doatresizer.appspot.com/?",url:"",width:0,height:0,encoding:"jpeg",padding:1,color:"#fff",quality:"80",ignoreRetina:false},M=["url","width","height","encoding","padding","color","quality"];P();function P(){$.extend(Q,O)}this.getSource=function(R){var T={};$.extend(T,Q,R);if(!T.url){alert("Must provide an image URL.");return}if(!T.width||!T.height){alert("Either image width or image height are not set.");return}if(a.Env.isRetina()&&!T.ignoreRetina){T.width=T.width*2;T.height=T.height*2}var W=T.resizerUrl,V;for(var U=0;U<M.length;U++){V=M[U];if(V==="url"&&(typeof T[V]==="object")){for(var S=0;S<T[V].length;S++){W+=(V+"="+T[V][S]+"&")}}else{W+=(V+"="+T[V]+"&")}}return W};this.getImageTag=function(R){var S={};$.extend(S,Q,R);var U=N.getSource(S);var T="";if(a.Env.isRetina()){T='style="width: '+(S.width/2)+"px; height: "+(S.height/2)+'px;"'}return'<img src="'+U+'" '+T+">"}};function n(){var Y=this,af,Q=document.getElementsByTagName("HEAD")[0],R,U,O,W,V,ah,Z,M,ac,ab,ag,ad,S={},N=(typeof doat_jsa!=="undefined"&&doat_jsa);if(typeof touchyjs_config!=="undefined"){S=q(S,touchyjs_config)}S.hasHost=/\sevme\//.test(navigator.userAgent);this.init=aa;this.renderHTML=P;this.openLink=X;this.getSearchQuery=ae;this.visible=this.focused=false;this.Log=new K();this.Events=new G();O=new L();this.Env=this.Environment=O;ac=O.getInfo();if(O.isMobile()){y("META",Q,{name:"viewport",content:"width=device-width initial-scale=1 minimum-scale=1 maximum-scale=1 user-scalable=0"});if(ac.platform.name==="iphone"){y("META",Q,{name:"apple-mobile-web-app-capable",content:"yes"})}$(document.body).css("-webkit-text-size-adjust","none")}var T=function(am,aj){if(!aj){return am}for(var ai in aj){var al=new RegExp("{"+ai+"}","g");var ak=aj[ai];am=am.replace(al,ak)}return am};function aa(){af=$(document);U=new f();Y.DOML=U;R=new J();R.setAuthFunc(function(al){if(al.source===top.window){return{error:"OK",attachData:{source:al.source}}}else{return{error:"Not authenticated",attachData:{origin:al.origin}}}});Y.Messenger=R;if(N){this.Log.info("Analytics enabled");m(R,O.isMobile())}else{this.Log.info("Analytics disabled")}V=new c({searchClearButton:S.searchClearButton});Y.Searchbar=V;Z=new w();Y.Slider=Z;M=new I();Y.Swiper=M;ah=new F();Y.Scroll=ah;W=new C(S);Y.Navigation=Y.Nav=W;Facebook=new e();if(S.facebook){Facebook.init(S.facebook)}Y.Facebook=Y.FB=Facebook;ab=new t();Y.Extractor=ab;ad=new r();Y.Viewport=ad;Y.Image=new b(S.image);$(window).bind("load",function(){R.trigger(a.Events.WINDOW_LOADED)});Y.Events.ready(function(){R.trigger(a.Events.DOAT_READY)});Y.Events.focused(function(){Y.focused=true});Y.Events.blurred(function(){Y.focused=false});Y.Events.visible(function(){Y.visible=true});Y.Events.hidden(function(){Y.visible=false});R.bind("focusState",function(am,al){Y.Events.dispatchEvent(al.type)});af.ready(function(){R.trigger(a.Events.DOCUMENT_READY);U.parse();ad.init({Storage:ag,"$container":$(document.body),logger:console});ad.setHeight();ad.hideAddressBar();O.addEventListener("orientationchange",function(){ad.setHeight();ad.hideAddressBar()});ah.init(S);W.init(S);z(document.body,"doml-env-"+ac.platform.name);ac.browser.name&&z(document.body,"doml-env-browser-"+ac.browser.name);if(O.isMobile()){z(document.body,"doml-env-mobile");if(S.webkitAnimation!==false){g(ac.platform.name,ac.browser.name,Y.Log)}}$("body").bind("click",function(an){var am=an.target||an.originalTarget;var al="";if(am){if(am.nodeName){al=am.nodeName}if(am.className!=""){al+="."+am.className}if(am.id!=""){al+="#"+am.id}if(am.firstChild&&am.firstChild.nodeType===3){var ap=am.firstChild.nodeValue;ap=E(ap);if(ap!==""){al+=' ("'+ap+'")'}}if(am.getAttribute("alt")&&am.getAttribute("alt")!==""){var ao=am.getAttribute("alt");ao=E(ao);al+=' ("'+ao+'")'}}R.trigger(a.Events.USER_ACTION,{action:"Click",element:al})});Y.Events.dispatchEvent("ready",{callOnce:true});if(S.browserHistory){W.initHistory()}});var ak=s();Y.params={query:"",experience:"",platform:""};for(var ai in ak){if(ai.indexOf("do_")===0){var aj=ai.substring(3,ai.length);Y.params[aj]=decodeURIComponent(ak[ai]).replace(/\+/g," ")}}R.trigger(a.Events.PAGE_VIEW,{action:"PageView",query:Y.params.query})}function ae(){return Y.params.query||""}function P(an,am){var aj;if(typeof an==="string"){aj=an}else{var ao="",ai=O.getInfo().platform.name;for(k in an){var al=k.split(",");for(var ak=0;ak<al.length;ak++){if(al[ak]===ai){aj=an[k];break}else{if(al[ak]==="default"){ao=an[k]}}}if(!aj){aj=ao}}}return T(aj,am)}function X(aB,ax){var ar,an=O.getInfo().platform.name,aw=O.isMobile(),al=ax||{};function ai(aD){return encodeURIComponent(encodeURIComponent(aD))}function ak(aD){if(typeof aD==="string"){aD={url:aD,newWindow:(!aw),label:((aD.indexOf("itms-apps://")!==-1||aD.indexOf("itms://")!==-1||aD.indexOf("http://itunes.apple.com")!==-1)?"Download from App Store":(aD.indexOf("http://")!==0&&aD.indexOf("https://")!==0)?"Launch installed app":aD)}}return aD}function aq(aE){if(!aE){return aE}var aG;aE=(aE instanceof Array)?aE:[aE];if(aw){aG={url:"doatJS://OpenLink"};for(var aF=0,aD=aE.length;aF<aD;aF++){var aH=ak(aE[aF]);if(aH.newWindow&&aH.url.indexOf("http")===0){aH.url="doatBrowser://"+aH.url}aH.url=ai(aH.url);aG.url+="/"+aH.url}}else{aG=ak(aE[0])}return aG}for(platform in aB){var am=platform.split(",");for(var aA=0,az=am.length;aA<az;aA++){if(E(am[aA])===an){if(typeof aB[platform]==="string"){aB[platform]=new Array(aB[platform])}ar=aB[platform];break}}if(ar){break}}if(!ar){ar=new Array(aB["default"])}if(ar.length==1){location.href=ar[0];return true}var aC=document.getElementById("alertView");if(!aC){var ap="#doatOpenWin ul { list-style-type: none; }#doatOpenWin ul li { padding: 6px 0; }#doatOpenWin ul li a { color: #fff; text-decoration: none; font-size: 13px; }#alertView{text-align: center;width: 250px;position: absolute;left: 50%;margin-left: -135px;border: 2px solid #fff;border-radius: 20px;-moz-border-radius: 20px;-webkit-border-radius: 20px;background:  rgba(59, 80, 119, 0.9) ;box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);-moz-box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);-webkit-box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);overflow:hidden;z-index:1000;padding:10px;display:none;}#alertView div#shine {position: absolute;top: -1474px;height: 1500px;width: 1500px;border-radius: 1500px;-moz-border-radius: 1500px;-webkit-border-radius: 1500px;background: rgb(255, 255, 255);left: -626px;background: -webkit-gradient(linear,left bottom,left top,color-stop(0, rgba(59,81,119, 0.5)),color-stop(0.06, rgba(255,255,255, 0.5)));background:    -moz-linear-gradient(center bottom,rgba(59,81,119, 0.5) 0%,rgba(255,255,255, 0.5) 4%);opacity: 1;filter: alpha(opacity = 05);z-index: 5;}#alertView h2, #alertView p{color: white;margin: 0;padding: 5px 10px;font: 12px / 1.1em Helvetica, Arial, sans-serif;position: relative;z-index: 20;}#alertView h2{text-align:center;font: 18px / 1.1em Helvetica, Arial, sans-serif;}#alertView div.button.white{background: -webkit-gradient(linear,left bottom,left top,color-stop(0.13, rgb(62,73,101)),color-stop(0.43, rgb(62,73,101)),color-stop(1, rgb(221,222,224)));background: -moz-linear-gradient(center bottom,rgb(62,73,101) 13%,rgb(62,73,101) 43%,rgb(221,222,224) 100%);}#alertView div.button{margin: 0 auto 6px;display: block;background: rgb(69, 90, 129);border: 1px solid rgb(59, 80, 119);border: 1px solid rgba(59, 80, 119, 1);border-radius: 5px;-moz-border-radius: 5px;-webkit-border-radius: 5px;background: -webkit-gradient(linear,left bottom,left top,color-stop(0.13, rgb(62,73,101)),color-stop(0.43, rgb(62,73,101)),color-stop(1, rgb(221,222,224)));background: -moz-linear-gradient(center bottom,rgb(62,73,101) 13%,rgb(62,73,101) 43%,rgb(221,222,224) 100%);}#alertView div.button p{text-align: center;margin: 0;padding: 0;}#alertView div.button p a{color: #333333;color: rgba(255, 255, 255, 1);text-decoration: none;font: bold 14px/1.2em Helvetica, Arial, sans-serif;margin: 0;display: block;padding: 7px 0 10px;text-shadow: 0 1px 1px #5E5E5E;border-radius: 5px;-moz-border-radius: 5px;-webkit-border-radius: 5px;}#alertView div.button p a:active {-moz-box-shadow: 0 0 15px white;-webkit-box-shadow: 0 0 15px white;}";y("style",Q,{innerHTML:ap});var ay=document.createElement("div");ay.id="doatOpenWin";var aC=document.createElement("div");aC.id="alertView";var av="<h2>Launching "+document.title+' app</h2><div class="links"></div>';av+='<div class="button" id="cancelButton"><p><a href="javascript://">Cancel</a></p></div>';av+='<div id="shine"></div>';aC.innerHTML=av;ay.appendChild(aC);document.body.appendChild(ay);ay.querySelector("#cancelButton").addEventListener("click",function(){aC.style.display="none"},false)}if(ar){var av="";for(var aA=0;aA<ar.length;aA++){var ao=ak(ar[aA]);av+='<div class="button"><p><a href="'+ao.url+'" '+((ao.newWindow)?'target="_blank"':"")+">"+ao.label+"</a></p></div>"}var at=document.querySelector("#alertView .links");at.innerHTML=av;var aj=at.querySelectorAll("a");for(var au=0;au<aj.length;au++){aj[au].addEventListener("click",function(){aC.style.display="none"},false)}}aC.style.display="block";aC.style.top=document.body.scrollTop+40+"px"}}var a=new n();if(!(typeof doat_config!=="undefined"&&doat_config.manualInit==true)){a.init()}window.TouchyJS=window.Doat=a})();