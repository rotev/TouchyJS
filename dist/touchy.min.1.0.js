(function(){function a(a,b,c,d,e){var f=b?b.ownerDocument:document;var g=f.createElement(a);if(c)for(var h in c){if(h=="style"){var i=c[h];for(var j in i)g.style.setProperty(j,i[j])}else g[h]=c[h]}if(d&&a=="script"){var k=false;var l=function(){if(k){return}k=true;d()};g.onload=l;g.onreadystatechange=function(){if(this.readyState=="loaded"){l()}}}if(b){try{b.insertBefore(g,e)}catch(m){b.insertBefore(g)}}return g}function b(){var a={};(location.search||"").replace(/([^=^&^?]+)=([^&]*)/g,function(b,c,d){a[c]=d});return a}function c(a,b,c){var d=function(a,b,c){a[c]=function(){return b[c].apply(b,arguments)}};for(var e in c){d(a,b,c[e])}}function d(a){if(!a)return a;var b=a.length,c=[],d={};while(b--){var e=a[b];if(!d[e]){d[e]=true;c.push(e)}}return c}function e(a,b){a=a||{};for(var c in b)a[c]=b[c];return a}function f(a,b){var c=a.className;b=c!==""?" "+b:b;a.className+=b}function g(a){if(a.trim){return a.trim()}else{return a.replace(/^\s+|\s+$/g,"")}}function j(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var a=arguments[0],b=arguments[1],c=arguments[2];if(typeof a.addEventListener!=="undefined"){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c,false)}}function l(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var a=arguments[0],b=arguments[1],c=arguments[2];if(typeof a.removeEventListener!=="undefined"){a.removeEventListener(b,c,false)}else if(a.detachEvent){a.detachEvent("on"+b,c)}}function n(){function d(b){var d=c(b);if(d.error==="OK"){var f=JSON.parse(b.data);f=e(f,d.attachData);var g=a[f["msnEventType"]];if(g){var h={source:b.source,type:f["msnEventType"]};delete f["msnEventType"];var i=f;for(var j=0;j<g.length;j++){var k=g[j];k(h,i)}}}}function f(b,c){b=b instanceof Array?b:[b];for(var d in b){var e=b[d];var f=a[e];if(!f)a[e]=f=[];f.push(c)}}function g(b,c){if(!c){a[b]=null}else{for(var d=a[b],e=d?d.length-1:-1;e>=0;--e){if(d[e]===c){d.splice(e,1);return}}}}function h(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=window.parent}var a=arguments[0];var c=arguments[2]||{};c["msnEventType"]=arguments[1];c=e(c,b);a.postMessage(JSON.stringify(c),"*")}function i(a){b=a}function k(a){c=a}var a=[],b={},c=function(){return{error:"OK"}};this.bind=f;this.unbind=g;this.trigger=h;this.attach=i;this.setAuthFunc=k;j(window,"message",d)}function o(a,b){function f(a,b){d.report(["_trackEvent","Tracing",a.type,b.query])}function g(a,b){c.error("Error getting search results "+JSON.stringify(b));f(a,b)}function i(a,b){var c;switch(b.action){case"Navigate":c="/"+b["to"];c+=b.title?"/"+b.title.replace("/","-"):"";break;case"Search":case"PageView":var e=b.newQuery||b.query;b.page=b.page||"search";c="/"+b.page;c+=e?"/"+e.replace("/","-"):"";break;default:return false}d.report(["_trackPageview",c]);return true}function j(a){var b=-1;if(typeof doat_ts!=="undefined"){b=(new Date).getTime()-doat_ts}d.report(["_trackEvent","Tracing",a.type,k(b),b])}function k(a){var b;for(b=0;b<=5;b++){if(a/1e3<b){return"under "+b+" sec"}}return"over "+(b-1)+" sec"}var c=M.Log||new h;var d=new q;d.load(c);if(b){var e=new r;e.load(c)}a.bind([M.Events.USER_ACTION,M.Events.PAGE_VIEW],i);a.bind([M.Events.WINDOW_LOADED,M.Events.RENDER_END],j);a.bind(M.Events.NO_RESULTS,f);a.bind([M.Events.RENDER_END,M.Events.NO_RESULTS],function(b,c){a.unbind(M.Events.RENDER_END,j);if(e){e.report(b.type)}});a.bind(M.Events.SEARCH_ERROR,g)}function q(){var b,c,d;if(/loc\.flyapps\.me/.test(location.host)){b="UA-16876190-2";c=".loc.flyapps.me"}else if(/test\.flyapps\.me/.test(location.host)){b="UA-16876190-8";c=".test.flyapps.me"}else if(/stg\.flyapps\.me/.test(location.host)){b="UA-16876190-7";c=".stg.flyapps.me"}else if(/flyapps\.me/.test(location.host)){b="UA-16876190-4";c=".flyapps.me"}this.report=function(a){try{_gaq.push(a);var b=!_gaq.length?"GA object":"temp array";d.info("Pushed event to _gaq ("+b+") -> "+JSON.stringify(a))}catch(c){d.error("An error occured when performing _gaq.push ("+JSON.stringify(a)+")")}};this.load=function(e){d=e;var f=typeof doat_appName=="undefined"?location.host.split(".")[0]:doat_appName;_gaq=typeof _gaq!=="undefined"?_gaq:[];_gaq.push(["_setAccount",b],["_setDomainName",c],["_setCustomVar",1,"appname",f]);d.info('Loading GA for account "'+b+'" under domain "'+c+'" with appname "'+f+'"');a("script",document.getElementsByTagName("HEAD")[0],{type:"text/javascript",src:("https:"==document.location.protocol?"https://ssl.":"http://www.")+"google-analytics.com/ga.js",async:"true"})}}function r(){var a;this.load=function(b){a=b};this.report=function(b,c){var d="doatJS://report/"+b;a.info('Reporting to native app -> "'+d+'"')}}function s(a,b,c){var d=s.WARN;var e=s.writeLogger;var f=false;this._isMobileBrowser=s.isMobileBrowser();this.setPrefix=function(a){if(a!="undefined"){f=a}else{f=false}};this.setLogger=function(a){if(a!="undefined"){e=a}if(a===s.writeLogger){var b=document.createElement("div");b.id="logger";b.style.backgroundColor="white";b.style.position="fixed";b.style.top="100px";b.style.left="0";b.style.zIndex="20";b.style.overflow="scroll";b.style.height="400px";document.body.appendChild(b);var c=document.createElement("a");c.innerHTML="clear";c.href="javascript://";c.addEventListener("click",function(){loggerList.innerHTML=""},false);b.appendChild(c);loggerList=document.createElement("ul");b.appendChild(loggerList)}};this.setLevel=function(a){if(a!="undefined"&&typeof a=="number"){d=a}else if(a!="undefined"){if(a=="debug"){d=s.DEBUG}else if(a=="info"){d=s.INFO}else if(a=="error"){d=s.ERROR}else if(a=="fatal"){d=s.FATAL}else if(a=="warn"){d=s.WARN}else{d=s.NONE}}};this.getPrefix=function(){return f};this.getLogger=function(){return e};this.getLevel=function(){return d};if(a!="undefined"){this.setLevel(a)}if(b!="undefined"){this.setLogger(b)}if(c!="undefined"){this.setPrefix(c)}}function u(){var a="http://doatresizer.appspot.com/?url={src}&width={width}&height={height}&cache=short&crop={crop}&default={default}",b={searchbar:{type:"replace",html:"<form "+'id="tml-searchbar-form" '+'onsubmit="TouchyJS.Searchbar.submitFunc({onsubmit}); return false;" '+">"+'<input type="text" '+'data-defaulttext="{defaulttext}" '+"onfocus=\"TouchyJS.Searchbar.clearValue('{defaulttext}')\" "+"onblur=\"TouchyJS.Searchbar.fillValue('{defaulttext}')\" "+'id="tml-searchbar-searchfield" '+'name="searchfield" '+'style="{style}" '+"data-clearbutton={clearbutton}"+"/>"+"</form>"},searcharea:{type:"replace",html:"<form "+'id="tml-searchbar-form" '+'onsubmit="TouchyJS.Searchbar.submitFunc({onsubmit}); return false;" '+">"+"<textarea "+"onfocus=\"TouchyJS.Searchbar.clearValue('{defaulttext}')\" "+"onblur=\"TouchyJS.Searchbar.fillValue('{defaulttext}')\" "+'id="tml-searchbar-searchfield" '+'name="searchfield" '+'style="{style}" '+"clearbutton={clearbutton}"+">{defaulttext}"+"</textarea>"+"</form>"},navigate:{type:"replace",html:'<a href="javascript://" class="{class}" onclick="TouchyJS.Navigation.goTo(\'{to}\')"><span>{label}</span></a>'},image:{type:"image",html:'<img src="'+a+'" alt="{alt}" />'}},c="tml",d={autoinit:"false"};var e=/\{([^}]*)\}/g;var f=function(a,b){var c={};return b?(""+b).replace(e,function(b,e){if(!c.hasOwnProperty(e)){c[e]=a.getAttribute(e)?a.getAttribute(e):d.hasOwnProperty(e)?d[e]:""}return c[e]}):b};var g=function(a,b){if($(a).replaceWith){$(a).replaceWith($(b))}else{var c=$(b)[0];a.parentNode.replaceChild(c,a)}};this.parse=function(a){!a&&(a=document.body);for(var d in b){if(b.hasOwnProperty(d)){var e=c+":"+d;var h=a.getElementsByTagName(e);for(var i=0;i<h.length;i++){var j=f(h[i],b[d].html);g(h[i],j);i--}}}};this.getImage=function(b){var c=new function(a){this.getAttribute=function(b){return a[b]}}(b);return f(c,a)}}function w(a){var b=this,c,d,e=a&&a.isTouch||"ontouchstart"in window;var f=function(a){a=(a||navigator.userAgent).toLowerCase();c={};c.platform=g(a);c.browser=i(a);c.os=h(a);c.orientation=k.getNew();c.screen=l.get(a);c.connection=m.get()};var g=function(a){var b="",c="",d;d=/(iphone|ipad)|(android|htc_)|(symbian)|(webos)|(blackberry|playbook|windows phone os)|(mobile;)/.exec(a)||[,"desktop"];b=d[1]||d[2]&&"android"||d[3]&&"nokia"||d[4]&&"hp"||d[5]&&""||d[6]&&"mozilla";return{name:b,version:c}};var h=function(a){var b="",c="",d;d=/(iphone|ipad)|(android|htc_)|(symbian|webos)|(blackberry|playbook)|(windows phone os)|(mobile;)/.exec(a)||[];b=d[1]&&"ios"||d[2]&&"android"||d[3]||d[4]&&"blackberry"||d[5]&&"windowsphoneos"||d[6]&&"firefoxos";if(!b){d=/(Win32)|(Linux)|(MacIntel)/.exec(navigator.platform)||[];b=d[1]&&"windows"||d[2]||d[3]&&"mac"||""}switch(b){case"ios":c=/os\s([\d_]+)\slike/.exec(a);c=c[1].replace(/_/g,".");break;case"android":c=/android\s([\d\.\-]+)[^;]*;/.exec(a);c=c&&c[1]&&c[1].replace(/-/g,"");break}return{name:b,version:c}};var i=function(a){var b,c="",d;a=a.toLowerCase();d=/(webkit)(?:[\/]|.+fbforiphone)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];b=d[1]||"";return{name:b,version:c}};this.getScreen=function(){return l.get()};this.setScreen=function(a){return l.set(a)};this.clearScreen=function(a){return l.clear(a)};this.setOrientation=function(a){k.set(a)};this.isTouch=function(){return e};this.isMobile=function(c){var d=b.getInfo(c).platform.name;return a&&a.isTouch||/^(iphone|ipad|android|nokia|blackberry)$/.test(d)};this.isRetina=function(){return window.devicePixelRatio>1};this.getInfo=function(){if(arguments[0]||!c){var a=arguments[0]===true?undefined:arguments[0];f(a)}return c};this.addEventListener=function(){if(typeof arguments[0]==="string"){arguments[2]=arguments[1];arguments[1]=arguments[0];arguments[0]=document}var a=arguments[0],b=arguments[1],c=arguments[2],d=e?"touchstart":"mousedown",f=e?"touchmove":"mousemove",g=e?"touchend":"mouseup";switch(b){case"orientationchange":k.onOrientationChange(c);break;case"swipeX":j(a,"swipeX",c);break;case"touch":var h,i,l=false;j(a,d,function(a){a=a.originalEvent||a;h={type:"start",position:{x:a.touches?a.touches[0].pageX:a.clientX,y:a.touches?a.touches[0].pageY:a.clientY}};c(a,h);l=true});j(document,f,function(a){if(!l){return false}a=a.originalEvent||a;i={type:"move",position:{x:a.touches?a.touches[0].pageX:a.clientX,y:a.touches?a.touches[0].pageY:a.clientY}};i["delta"]={x:i.position.x-h.position.x,y:i.position.y-h.position.y};c(a,i)});j(document,g,function(a){l=false;if(!i||i.delta.x===0&&i.delta.y===0){return false}a=a.originalEvent||a;var b={type:"end",position:i.position,delta:i.delta,swipeEvent:true,direction:i.delta.x>0?"ltr":"rtl"};c(a,b);i=undefined});break}};var k=new function(){function g(c){var d=c&&!c.type?i(c):a.getNew();if(!b||d.degree!==b.degree){b=d;j();h()}}function h(){e.forEach(function(a){a(b)})}function i(a){var b,c;if(typeof a==="String"){b=a;c=a=="landscape"?90:0}else{c=a;b=Math.abs(a)==90?"landscape":"portrait"}return{name:b,degree:c}}function j(){var a=c+b.name;if(b.degree==90){a+=" "+c+"landscape-right"}else if(b.degree==-90){a+=" "+c+"landscape-left"}document.body.className=document.body.className.replace(d,"")+" "+a}var a=this,b,c="orientation-",d=new RegExp(c+"[^\\s]+","g"),e=[],f="orientation"in window;if(window.addEventListener){window.addEventListener(f?"orientationchange":"resize",g,false);document.addEventListener("DOMContentLoaded",g,false)}this.set=g;this.getCurrent=function(){return b||a.getNew()};this.getOtherName=function(a){return a==="portrait"?"landscape":"portrait"};this.getNew=function(){var b=f?window.orientation:a.getOrientationByWindowSize();return i(b)};this.getOrientationByWindowSize=function(){return window.innerHeight>window.innerWidth?0:90};this.onOrientationChange=function(a){e.push(a)}};k.onOrientationChange(function(){c.orientation=k.getCurrent();c.screen=l.get()});var l=new function(){function c(a,c){!a&&(a=navigator.userAgent);a=a.toLowerCase();var d=g(a).name;var e=h(a).name;var f=["","","",""];if(/^(iphone|ipod)$/.test(d)){var i=64,j=53;if(window.screen.height==568){f=[320,568-i,568,320-j]}else{f=[320,416,480,267]}}else if(d=="desktop"){f=[320,416,480,267]}else if(e=="android"){if(/nexus s/.test(a)){f=[320,508,508,295]}else if(/gt-9000/.test(a)){f=[320,508,508,320]}else if(/sonyericssonr800a/.test(a)){f=[320,544,544,320]}else if(/htc desire s/.test(a)){f=[320,533,533,320]}}else if(e=="windowsphoneos"){f=[295,486,"",""]}b={portrait:{width:f[0],height:f[1]},landscape:{width:f[2],height:f[3]}}}function d(a){var c;if(window.innerWidth<=window.outerWidth&&window.innerWidth!==b[k.getOtherName(a)].width){c=window.innerWidth}return c}var a=this,b;this.set=function(a){for(var c in a){for(var d in a[c]){b[c][d]=a[c][d]}}};this.get=function(a){var e=k.getCurrent().name;if(a||!b){c(a)}!b[e].width&&(b[e].width=d(e));return b[e]};this.clear=function(b){var c={};c[b]={height:"",width:""};a.set(c)}};var m=new function(){function e(){return f({},c,d[b])}function f(){var a=arguments[0];for(var b=1,c=arguments.length;b<c;b++){for(var d in arguments[b]){a[d]=arguments[b][d]}}return a}var a=this,b,c={SPEED_UNKNOWN:100,SPEED_HIGH:30,SPEED_MED:20,SPEED_LOW:10},d=[{name:undefined,speed:c.SPEED_UNKNOWN},{name:"etherenet",speed:c.SPEED_HIGH},{name:"wifi",speed:c.SPEED_HIGH},{name:"2g",speed:c.SPEED_LOW},{name:"3g",speed:c.SPEED_MED}];this.get=function(){return e()};this.set=function(a){b=a||navigator.connection&&navigator.connection.type||0;return e()};a.set()}}function z(){var a,b,c,d={lines:10,length:7,width:3,radius:7,color:"#ffffff",speed:1.4,trail:72,shadow:true,parent:document.body},e={position:"absolute",left:"50%",top:"50%","z-index":200};var f=function(a){var f={};for(i in d)f[i]=d[i];for(i in a)f[i]=a[i];var g=a.parent||$(document.body);$mainEl=g.children(".doml-progress-indicator");if($mainEl.length===0){$mainEl=$('<span class="doml-progress-indicator" />');$mainEl.css(e);g.append($mainEl)}c=$mainEl[0];b=new Spinner(f);b.spin(c)};var g=function(){$mainEl=$('<span class="doml-progress-indicator" />');$mainEl.css(e);$(document.body).append($mainEl);c=$mainEl[0];a=new Spinner(d)};this.show=function(b){if(b){f(b)}else{if(!a){g()}a.spin(c)}};this.hide=function(){if(b){b.stop()}if(a){a.stop()}}}function C(){var a,b={position:"absolute",top:"5px",cursor:"pointer","background-color":"#BBBBBB",width:"16px",height:"16px","text-align":"center","line-height":"17px","border-radius":"8px","-webkitborder-radius":"8px","-moz-border-radius":"8px",color:"white","font-weight":"bold","font-size":"12px","font-family":"arial","text-shadow":"none",leftOffset:-19};this.init=function(c){for(i in c.css)b[i]=c.css[i];b["left"]=b.left+b.leftOffset+"px";a=$("<span/>");a.addClass("tml-searchbar-clear").html("X").css(b).click(function(a){a.preventDefault();c.onClick()});return a[0]};this.show=function(){a.show()};this.hide=function(){a.hide()}}function E(){function r(){var a=c.parent().get(0);M.Env.addEventListener(a,"touch",function(a,b){switch(b.type){case"start":u(c);h&&q.autoplayStop();break;case"move":q.move(b.delta.x);break;case"end":if(!b["swipeEvent"]){q.showCurrentItem()}else{a=a.originalEvent||a;a.preventDefault();v(c);if(b.direction=="rtl"){q.next()}else{q.prev()}}break}});if(b&&i){a=b.parent().get(0);M.Env.addEventListener(a,"touch",function(a,c){switch(c.type){case"start":u(b);h&&q.autoplayStop();break;case"move":q.moveTabs(c.delta.x);break;case"end":if(!c["swipeEvent"]){q.showCurrentItem(true)}else{a=a.originalEvent||a;a.preventDefault();v(b);if(c.direction=="rtl"){q.nextTabs()}else{q.prevTabs()}}break}})}$(document).bind("keyup",function(a){if(g){switch(a.keyCode){case 36:h&&q.autoplayStop();q.setItem(0);break;case 35:h&&q.autoplayStop();q.setItem(m-1);break;case 39:h&&q.autoplayStop();q.next();break;case 37:h&&q.autoplayStop();q.prev();break}}})}function s(){w(a);w(b);w(c);c.parent().css({width:j+"px",overflow:"hidden"});c.find("li").css({"float":"left",width:j+"px"});c.css({width:j*m+"px","list-style-type":"none",overflow:"hidden"});if(b&&k!==0){b.css({width:k*m+"px","list-style-type":"none",overflow:"hidden"})}}function t(){a.show();g=true}function u(a){a.css({"-moz-transition":"-moz-transform 0s","-webkit-transition":"-webkit-transform 0s",transition:"transform 0s"})}function v(a){a&&a.css({"-moz-transition":" -moz-transform "+o+"s ease-out","-webkit-transition":"-webkit-transform "+o+"s ease-out",transition:"transform "+o+"s ease-out"})}function w(a){a&&a.css({"-webkit-transform":"translate3d(0px, 0px, 0px) rotate(0deg) scale(1)","-webkit-box-sizing":"border-box","-webkit-backface-visibility":"hidden"})}var a=null,b=null,c=null,d=null;var e=0,f=0,g=false,h=true,i=false;var j=320,k=0,l=5,m=0,n=null;var o="0.5",p=4e3;var q=this;this.init=function(e){e=e||{};a=e.element||null;b=e.navElement||null;c=e.itemsElement||null;d=e.onSelect||null;e.itemWidth&&(j=e.itemWidth);e.thumbWidth&&(k=e.thumbWidth);e.numVisibleThumbs&&(l=e.numVisibleThumbs);e.animationSpeed&&(o=e.animationSpeed);e.autoplay&&typeof e.autoplay=="number"&&(p=e.autoplay);h=typeof e.stopAutoplayOnTouch=="boolean"?e.stopAutoplayOnTouch:true;i=typeof e.thumbsSwipe=="boolean"?e.thumbsSwipe:false;onHitStartArr=[],onHitEndArr=[],onHitStart=function(){onHitStartArr.forEach(function(a){a.apply(arguments)})};onHitEnd=function(){onHitEndArr.forEach(function(a){a.apply(arguments)})};e.onHitStartCallback&&onHitStartArr.push(e.onHitStartCallback);e.onHitEndCallback&&onHitEndArr.push(e.onHitEndCallback);m=c.find("li").length;s();r();if(b){var f=b.find("li");f.click(function(){q.setItemByThumb(this)});$(f[0]).addClass("active")}t();if(e.autoplay){q.autoplayStart();if(e.stopAutoplayOnFocus){M.Events.focused(function(){q.autoplayStop()});M.Events.blurred(function(){q.autoplayStart()})}}};this.autoplayStart=function(){if(n!==null){q.autoplayStop()}n=setInterval(function(){q.next(true)},p)};this.autoplayStop=function(){clearInterval(n);n=null};this.show=function(a){if(a&&a.delay){setTimeout(t,a.delay)}else{t()}};this.hide=function(){a.hide();g=false};this.removeItem=function(a){var d=typeof a=="number"?c.children()[a]:a;var f=q.index(d);$(d).remove();b&&$(b.children()[f]).remove();m--;if(e==f){e--;if(e<=0){e=0}}q.showCurrentItem()};this.move=function(a){c.css({"-webkit-transform":"translate("+ -(e*j-a)+"px)","-moz-transform":"translate("+ -(e*j-a)+"px)",transform:"translate("+ -(e*j-a)+"px)"})};this.moveTabs=function(a){b&&b.css({"-webkit-transform":"translate("+ -(f*k-a)+"px)","-moz-transform":"translate("+ -(f*k-a)+"px)",transform:"translate("+ -(f*k-a)+"px)"})};this.prev=function(){e--;if(e<0){e=0;onHitStart()}q.showCurrentItem()};this.next=function(a){e++;if(e==m){e=a?0:m-1;onHitEnd()}q.showCurrentItem()};this.prevTabs=function(){f-=l;if(f<=0){f=0}q.showCurrentItem(true)};this.nextTabs=function(){f+=l;if(f>=m-l){f=m-l}q.showCurrentItem(true)};this.setItemByThumb=function(a){q.setItem(q.index(a))};this.getCurrent=function(){return e};this.index=function(a){a=$(a);var b=a.parent().children();for(var c=0;c<b.length;c++){if(b[c]==a[0]){return c}}return-1};this.setItem=function(a){e=a;q.showCurrentItem()};this.showCurrentItem=function(a){var g=a&&b?b:c;var h=a&&b?-(f*k):-(e*j);v(g);g.css({"-webkit-transform":"translate("+h+"px)","-moz-transform":"translate("+h+"px)",transform:"translate("+h+"px)"});d&&d(e);c.find(".active").removeClass("active");$(c.children("li")[e]).addClass("active");if(b){b.find(".active").removeClass("active");$(b.children("li")[e]).addClass("active")}if(!a){var i=Math.floor(e/l)*l;if(i!=f){f=i;q.showCurrentItem(true)}}}}function F(){function r(){document.body.removeEventListener("touchstart",r);var a=c.Nav.getCurrent();$(a).css("height",window.screen&&window.screen.availHeight+"px"||"1000px");window.scrollTo(0,0);setTimeout(function(){b.refreshAll()},1e3)}function s(a){a=a&&a.length?a:i.children("."+e);j=j||i.children("."+f);var b=j.length?j[0].offsetHeight:0,c=window.innerHeight-parseInt(i.css("margin-top"),10)-parseInt(i.css("margin-bottom"),10)-b;a.css({width:"100%",position:"absolute",top:b+"px"});if(n.fixedPositioning){q(n.fixedPositioning==="capableOnly")}}function u(a,b){var c=a.split(".");var d=b.split(".");for(var e=0;e<c.length;++e){if(d.length==e){return true}if(c[e]==d[e]){continue}else if(parseInt(c[e],10)>parseInt(d[e],10)){return true}else{return false}}if(c.length!=d.length){return false}return true}var b=this,c,d,e,f,g,h=[],i,j,l=document.getElementsByTagName("head")[0],m={vScrollbar:true,hScroll:false,useTransform:false},n;var o=function(){var a=$("."+e);return a.length>0};var q=function(){if(t()){c.Log&&c.Log.info(c.Env.getInfo().platform+" "+c.Env.getInfo().version+" has fixed positioning so using position: fixed");j.css({position:"fixed",top:0,left:0,width:"100%","z-index":2});$contents.css({top:j.get(0).offsetHeight+"px",height:"auto","z-index":1})}else{c.Log&&c.Log.info(c.Env.getInfo().platform+" "+c.Env.getInfo().version+" has NO fixed positioning so using iScroll");if(h.length==0){document.body.addEventListener("touchmove",function(a){},false)}for(var b=0,e=$contents.length;b<e;b++){var f=$contents[b];var g=$(f);var i=f.getAttribute("id");if(h[i]){h[i].refresh.call(h[i])}else if(!(n.disableIScroll&&n.disableIScroll[i])){g.css({visibility:"hidden",display:"block"});var o={};for(k in m)o[k]=m[k];var p=$(f).children("*");var q=p.length===1;if(!q){var r=document.createElement("div");r.className=d+"created";r.style.width="100%";for(var b=0,e=f.children.length;b<e;b++){alert(f.children[b]);r.appendChild(f.children[b])}f.appendChild(r)}else{p[0].style.width="100%"}if(n.pullToRefresh===i){var s="touchy-pulldown",u="touchy-pulldown-icon",v="touchy-pulldown-flip",w="touchy-pulldown-loading",x="touchy-pulldown-label",y={pull:"Pull down to refresh...",release:"Release to refresh...",loading:"Loading..."};var z="#"+s+" {"+"     background:#000000;"+"     height:40px;"+"     line-height:40px;"+"     padding:5px 10px;"+"     font-weight:bold;"+"     font-size:14px;"+"     color:#888888;"+"     visibility:hidden"+"}"+"#"+s+" ."+u+" {"+"     display:block; float:left;"+"     width:40px; height:40px;"+"     background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAACgCAMAAACsXRuGAAAAt1BMVEX////FxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcU7SVrkAAAAPHRSTlMAAPONxyCMRvCjM2n59gzeD/xssVo52Akwh6sDpeTbckJLZroqfhUnRernVxifG9XDgb2ZzzxjeLThEmBcLCjmAAACDklEQVR4Xu2Y124yQQyFM9sh9BJafgik956/7fs/V4RCwiITbMdjCSGfKy4On7THnuLZ8yGTyRWUr1W54NgNIC4Dbm+VrQ+tbQxoQAMa0IAGnO4vtR44WBquCcBuJadrSslwQucNaBm2qbyHEQ3YqNN4l3fUKpdpMV7Q26ZF4T3S+5AU49OIA8RjvLpxDCAeY/PIcYB4jKf8tTzcxDt2fGBt/D3v19kPgK5fRQLkAt0MCZANdIdIgGxg7WBjgHygO1kTY/NVMla8QeBvJwHCGP84CRDG+PefBAhjrHTlo9n/InDiY9a7XfLazgewd//Jqze8AN15sAiw7Gu87XwAW/7m5ec5b+j8AXsveT6uSYAwxmrf7xNBZ+aYQJPJZDLh+20aRlkWhen8twdgnCyO0SCJfQDjUv6lUuwBmOQFJXJgGhSBQSoGhvmKQnFNo1VgBD3MmmarwAx6WDWFQOhh1RR+MvSwagqLwqw7/ndW3UkfCD2bhJcAephAvJGYn4y3OrMouIfZNriH19i4h7v0cI9ww4ce4ZEEPTt6/uJ+UdS4H28G1C9qV9yPLyjUL1vyuB/dlLh+dNtE/dpA+SdrF0XeNsqNLV96+puDfPvaaukfUvJjVP+gl19F9C9L8uuc/oVTfiXWv7TLxwr9wUc+msmHR/3xVj6A6z8RSBej/jMLp+76T1X6j2m7eP6aTO9STHV4CXebKAAAAABJRU5ErkJggg%3D%3D); 0 0 no-repeat;"+"     -webkit-background-size:40px 80px; background-size:40px 80px;"+"     -webkit-transition-property:-webkit-transform;"+"     -webkit-transition-duration:250ms;"+"     -webkit-transform:rotate(0deg) translateZ(0);"+"}"+"#"+s+"."+v+" ."+u+" {"+"     -webkit-transform:rotate(-180deg) translateZ(0);"+"}"+"#"+s+"."+w+" ."+u+" {"+"     background-position:0 100%;"+"     -webkit-transform:rotate(0deg) translateZ(0);"+"     -webkit-transition-duration:0ms;"+"     -webkit-animation-name:"+w+";"+"     -webkit-animation-duration:2s;"+"     -webkit-animation-iteration-count:infinite;"+"     -webkit-animation-timing-function:linear;"+"}"+"@-webkit-keyframes "+w+" {"+"     from { -webkit-transform:rotate(0deg) translateZ(0); }"+"     to { -webkit-transform:rotate(360deg) translateZ(0); }"+"}";a("style",l,{type:"text/css",innerHTML:z});var A='<div id="'+s+'">'+'    <span class="'+u+'"></span>'+'    <span class="'+x+'">'+y.pull+"</span>"+"</div>";p.prepend(A);$pullDownElement=$("#"+s);$pullDownLabelClass=$pullDownElement.find("."+x);pullDownOffset=$pullDownElement[0].offsetHeight;var B={onRefresh:function(){$pullDownElement.css("visibility","visible");$pullDownElement.removeAttr("class");$pullDownLabelClass.html(y.pull)},onScrollMove:function(){if(this.y>5&&!$pullDownElement.hasClass(v)){$pullDownElement.addClass(v);$pullDownLabelClass.html(y.release);this.minScrollY=0}else if(this.y<5&&$pullDownElement.hasClass(v)){$pullDownElement.removeAttr("class");$pullDownLabelClass.html(y.pull);this.minScrollY=-pullDownOffset}},onScrollEnd:function(){if($pullDownElement.hasClass(v)){$pullDownElement.removeAttr("class");$pullDownLabelClass.html(y.loading);if(doat_config.pullToRefreshCB){doat_config.pullToRefreshCB()}h[i].refresh.call(h[i]);$pullDownElement.parent().css("-webkit-transform","translate3d(0px, -"+pullDownOffset+"px, 0px) scale(1)")}},topOffset:pullDownOffset,useTransition:true,useTransform:true};for(k in B)o[k]=B[k]}h[i]=new iScroll(i,o);g.bind("touchstart",{id:i},function(a){var b=a.data.id;h[b].refresh.call(h[b])});g.css({display:"none",visibility:"visible"})}}}};this.init=function(a){n=a;i=$(document.body);c=window.TouchyJS;d="tml_";e=d+"content";f=d+"header";g=d+"scrollable";$contents=i.find("."+e);c.Env.addEventListener("orientationChange",s);if($contents.length>0){s($contents);var b=n.displayContent||0,h=$contents[b];$(h).css("display","block");c.Nav.setCurrent(h)}};this.refresh=function(a,b){a=a||c.Nav.getCurrent().getAttribute("id");if(b){$("#"+a).children("*").css("height",b+"px")}if(h[a]){h[a].refresh()}};this.refreshAll=function(){s()};this.scrollTo=function(a){var b=c.Nav.getCurrent(),d=b.getAttribute("id");if(h[d]){h[d].scrollTo(0,a,0)}else{b.scrollTop=a}};this.disable=function(){var a=c.Nav.getCurrent(),b=a.getAttribute("id");if(h[b]){h[b].disable()}};this.enable=function(){var a=c.Nav.getCurrent(),b=a.getAttribute("id");if(h[b]){h[b].enable()}};var t=function(){if(!c.Env.isMobile()){return true}var a=c.Env.getInfo();p=a.platform,v=a.version;if(p==="iphone"||p==="ipad"){return u(v,"5")}else if(p==="android"){return u(v,"2.2")}return false}}function G(a,b,c){function h(a){for(var b=0;b<g.length;b++){if(a.indexOf(g[b])!==-1){return true;break}}return false}function i(a){a=a.toString();return a.indexOf("-")===0?a.substring(1,a.length):"-"+a}function j(a,b,c){var d=c.indexOf("-=")!==-1?-1:1;c=c.toString();var e=parseInt(c.substring(2,c.length),10).toString();var f=c.substring(2+e.length,c.length);var g=a.css(b);g=g&&g!==""?parseInt(g,10):0;var h=g+d*e+f;return h}function k(){var b={};if(a!=="android"){b[CSS_PREFIX+"transform"]="translate3d(0px, 0px, 0px) rotate(0deg) scale(1)";b[CSS_PREFIX+"box-sizing"]="border-box";b[CSS_PREFIX+"backface-visibility"]="hidden";c&&c.info("Including cfg['"+CSS_PREFIX+"transform'] = 'translate3d(0px, 0px, 0px) rotate(0deg) scale(1)'")}else{c&&c.info("not including cfg['"+CSS_PREFIX+"transform'] = 'translate3d(0px, 0px, 0px) rotate(0deg) scale(1)'")}$(".doml_content").css(b)}c&&c.info("platform="+a);var d=document.body.style.animationName,e=["Webkit","Moz","O","ms","Khtml"];if(!d){for(var f=0;f<e.length;f++){if(document.body.style[e[f]+"AnimationName"]!==undefined){CSS_PREFIX="-"+e[f].toLowerCase()+"-";d=true;break}}}if(!d){return false}var g=["scale","rotate","skew","translate","matrix"];k();$.fn.fadeIn=function(){var a=H(arguments);return $(this).animate({opacity:1},a.dur,a.ease,a.cb)};$.fn.fadeOut=function(){var a=H(arguments);return $(this).animate({opacity:0},a.dur,a.ease,a.cb)};$.fn.animate=function(){var a=this;var b,c,d,e,f=[];for(var g=1;g<arguments.length;g++){var k=arguments[g];if(typeof k==="function"){f.push(k)}else if(k==="fast"||k==="slow"){d=k}else if(typeof k==="string"){e=k}else{d=k}}c=arguments[0];c[CSS_PREFIX+"transform"]="";for(b in c){var l;if(c[b].toString().indexOf("=")!==-1){c[b]=j(a,b,c[b])}if(h(b)){c[CSS_PREFIX+"transform"]+=b+"("+c[b]+")";delete c[b]}else if(b==="left"||b==="right"){l=b==="right"?i(c[b]):c[b];c[CSS_PREFIX+"transform"]+="translateX("+l+")";delete c[b]}else if(b==="bottom"||b==="top"){l=b==="bottom"?i(c[b]):c[b];c[CSS_PREFIX+"transform"]+="translateY("+l+")";delete c[b]}}d=d==="fast"?.2:d==="slow"?.6:d/1e3||.3;e=!e||e==="swing"?"ease-in-out":e;if(f.length>0){setTimeout(function(){var b,c=f.length;for(b=0;b<c;b++){f[b].call(a)}},d*1e3)}c[CSS_PREFIX+"transition"]="all "+d+"s "+e;return a.css(c)}}function H(a){var b={};for(var c=0;c<a.length;c++){var d=a[c];if(typeof d==="function"){b.cb=d}else if(d==="fast"||d==="slow"){b.dur=d}else if(typeof d==="string"){b.ease=d}else{b.dur=d}}return b}function L(){function Q(){d=$(document);l=new u;c.DOML=l;j=new n;j.setAuthFunc(function(a){if(a.source===top.window){return{error:"OK",attachData:{source:a.source}}}else{return{error:"Not authenticated",attachData:{origin:a.origin}}}});c.Messenger=j;if(O){this.Log.info("Analytics enabled");o(j,m.isMobile())}else{this.Log.info("Analytics disabled")}q=new B({searchClearButton:N.searchClearButton});c.Searchbar=q;s=new D;c.Slider=s;v=new E;c.Swiper=v;r=new F;c.Scroll=r;p=new y(N);c.Navigation=c.Nav=p;Facebook=new I;if(N.facebook){Facebook.init(N.facebook)}c.Facebook=c.FB=Facebook;C=new t;c.Extractor=C;L=new J;c.Viewport=L;c.Image=new K(N.image);$(window).bind("load",function(){j.trigger(M.Events.WINDOW_LOADED)});c.Events.ready(function(){j.trigger(M.Events.DOAT_READY)});c.Events.focused(function(){c.focused=true});c.Events.blurred(function(){c.focused=false});c.Events.visible(function(){c.visible=true});c.Events.hidden(function(){c.visible=false});j.bind("focusState",function(a,b){c.Events.dispatchEvent(b.type)});d.ready(function(){j.trigger(M.Events.DOCUMENT_READY);l.parse();L.init({Storage:H,$container:$(document.body),logger:console});L.setHeight();L.hideAddressBar();m.addEventListener("orientationchange",function(){L.setHeight();L.hideAddressBar()});r.init(N);p.init(N);f(document.body,"doml-env-"+z.platform.name);z.browser.name&&f(document.body,"doml-env-browser-"+z.browser.name);if(m.isMobile()){f(document.body,"doml-env-mobile");if(N.webkitAnimation!==false){G(z.platform.name,z.browser.name,c.Log)}}$("body").bind("click",function(a){var b=a.target||a.originalTarget;var c="";if(b){if(b.nodeName){c=b.nodeName}if(b.className!=""){c+="."+b.className}if(b.id!=""){c+="#"+b.id}if(b.firstChild&&b.firstChild.nodeType===3){var d=b.firstChild.nodeValue;d=g(d);if(d!==""){c+=' ("'+d+'")'}}if(b.getAttribute("alt")&&b.getAttribute("alt")!==""){var e=b.getAttribute("alt");e=g(e);c+=' ("'+e+'")'}}j.trigger(M.Events.USER_ACTION,{action:"Click",element:c})});c.Events.dispatchEvent("ready",{callOnce:true});if(N.browserHistory){p.initHistory()}});var a=b();c.params={query:"",experience:"",platform:""};for(var e in a){if(e.indexOf("do_")===0){var h=e.substring(3,e.length);c.params[h]=decodeURIComponent(a[e]).replace(/\+/g," ")}}j.trigger(M.Events.PAGE_VIEW,{action:"PageView",query:c.params.query})}function R(){return c.params.query||""}function S(a,b){var c;if(typeof a==="string"){c=a}else{var d="",e=m.getInfo().platform.name;for(k in a){var f=k.split(",");for(var g=0;g<f.length;g++){if(f[g]===e){c=a[k];break}else if(f[g]==="default"){d=a[k]}}if(!c)c=d}}return P(c,b)}function T(b,c){function j(a){return encodeURIComponent(encodeURIComponent(a))}function k(a){if(typeof a==="string"){a={url:a,newWindow:!f,label:a.indexOf("itms-apps://")!==-1||a.indexOf("itms://")!==-1||a.indexOf("http://itunes.apple.com")!==-1?"Download from App Store":a.indexOf("http://")!==0&&a.indexOf("https://")!==0?"Launch installed app":a}}return a}function l(a){if(!a){return a}var b;a=a instanceof Array?a:[a];if(f){b={url:"doatJS://OpenLink"};for(var c=0,d=a.length;c<d;c++){var e=k(a[c]);if(e["newWindow"]&&e.url.indexOf("http")===0){e.url="doatBrowser://"+e.url}e.url=j(e.url);b["url"]+="/"+e.url}}else{b=k(a[0])}return b}var d,e=m.getInfo().platform.name,f=m.isMobile(),h=c||{};for(platform in b){var n=platform.split(",");for(var o=0,p=n.length;o<p;o++){if(g(n[o])===e){if(typeof b[platform]==="string"){b[platform]=new Array(b[platform])}d=b[platform];break}}if(d){break}}if(!d){d=new Array(b["default"])}if(d.length==1){location.href=d[0];return true}var q=document.getElementById("alertView");if(!q){var r="#doatOpenWin ul { list-style-type: none; }"+"#doatOpenWin ul li { padding: 6px 0; }"+"#doatOpenWin ul li a { color: #fff; text-decoration: none; font-size: 13px; }"+"#alertView{"+"text-align: center;"+"width: 250px;"+"position: absolute;"+"left: 50%;"+"margin-left: -135px;"+"border: 2px solid #fff;"+"border-radius: 20px;"+"-moz-border-radius: 20px;"+"-webkit-border-radius: 20px;"+"background:  rgba(59, 80, 119, 0.9) ;"+"box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);"+"-moz-box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);"+"-webkit-box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);"+"overflow:hidden;"+"z-index:1000;"+"padding:10px;"+"display:none;"+"}"+"#alertView div#shine {"+"position: absolute;"+"top: -1474px;"+"height: 1500px;"+"width: 1500px;"+"border-radius: 1500px;"+"-moz-border-radius: 1500px;"+"-webkit-border-radius: 1500px;"+"background: rgb(255, 255, 255);"+"left: -626px;"+"background: -webkit-gradient("+"linear,"+"left bottom,"+"left top,"+"color-stop(0, rgba(59,81,119, 0.5)),"+"color-stop(0.06, rgba(255,255,255, 0.5))"+");"+"background:    -moz-linear-gradient("+"center bottom,"+"rgba(59,81,119, 0.5) 0%,"+"rgba(255,255,255, 0.5) 4%"+");"+"opacity: 1;"+"filter: alpha(opacity = 05);"+"z-index: 5;"+"}"+"#alertView h2, #alertView p{"+"color: white;"+"margin: 0;"+"padding: 5px 10px;"+"font: 12px / 1.1em Helvetica, Arial, sans-serif;"+"position: relative;"+"z-index: 20;"+"}"+"#alertView h2{"+"text-align:center;"+"font: 18px / 1.1em Helvetica, Arial, sans-serif;"+"}"+"#alertView div.button.white{"+"background: -webkit-gradient("+"linear,"+"left bottom,"+"left top,"+"color-stop(0.13, rgb(62,73,101)),"+"color-stop(0.43, rgb(62,73,101)),"+"color-stop(1, rgb(221,222,224))"+");"+"background: -moz-linear-gradient("+"center bottom,"+"rgb(62,73,101) 13%,"+"rgb(62,73,101) 43%,"+"rgb(221,222,224) 100%"+");"+"}"+"#alertView div.button{"+"margin: 0 auto 6px;"+"display: block;"+"background: rgb(69, 90, 129);"+"border: 1px solid rgb(59, 80, 119);"+"border: 1px solid rgba(59, 80, 119, 1);"+"border-radius: 5px;"+"-moz-border-radius: 5px;"+"-webkit-border-radius: 5px;"+"background: -webkit-gradient("+"linear,"+"left bottom,"+"left top,"+"color-stop(0.13, rgb(62,73,101)),"+"color-stop(0.43, rgb(62,73,101)),"+"color-stop(1, rgb(221,222,224))"+");"+"background: -moz-linear-gradient("+"center bottom,"+"rgb(62,73,101) 13%,"+"rgb(62,73,101) 43%,"+"rgb(221,222,224) 100%"+");"+"}"+"#alertView div.button p{"+"text-align: center;"+"margin: 0;"+"padding: 0;"+"}"+"#alertView div.button p a{"+"color: #333333;"+"color: rgba(255, 255, 255, 1);"+"text-decoration: none;"+"font: bold 14px/1.2em Helvetica, Arial, sans-serif;"+"margin: 0;"+"display: block;"+"padding: 7px 0 10px;"+"text-shadow: 0 1px 1px #5E5E5E;"+"border-radius: 5px;"+"-moz-border-radius: 5px;"+"-webkit-border-radius: 5px;"+"}"+"#alertView div.button p a:active {"+"-moz-box-shadow: 0 0 15px white;"+"-webkit-box-shadow: 0 0 15px white;"+"}";a("style",i,{innerHTML:r});var s=document.createElement("div");s.id="doatOpenWin";var q=document.createElement("div");q.id="alertView";var t="<h2>Launching "+document.title+' app</h2><div class="links"></div>';t+='<div class="button" id="cancelButton"><p><a href="javascript://">Cancel</a></p></div>';t+='<div id="shine"></div>';q.innerHTML=t;s.appendChild(q);document.body.appendChild(s);s.querySelector("#cancelButton").addEventListener("click",function(){q.style.display="none"},false)}if(d){var t="";for(var o=0;o<d.length;o++){var u=k(d[o]);t+='<div class="button"><p><a href="'+u.url+'" '+(u.newWindow?'target="_blank"':"")+">"+u.label+"</a></p></div>"}var v=document.querySelector("#alertView .links");v.innerHTML=t;var w=v.querySelectorAll("a");for(var x=0;x<w.length;x++){w[x].addEventListener("click",function(){q.style.display="none"},false)}}q.style.display="block";q.style.top=document.body.scrollTop+40+"px"}var c=this,d,i=document.getElementsByTagName("HEAD")[0],j,l,m,p,q,r,s,v,z,C,H,L,N={},O=typeof doat_jsa!=="undefined"&&doat_jsa;if(typeof touchyjs_config!=="undefined"){N=e(N,touchyjs_config)}N.hasHost=/\sevme\//.test(navigator.userAgent);this.init=Q;this.renderHTML=S;this.openLink=T;this.getSearchQuery=R;this.visible=this.focused=false;this.Log=new h;this.Events=new x;m=new w;this.Env=this.Environment=m;Transitions=A;this.Transitions=Transitions;z=m.getInfo();if(m.isMobile()){a("META",i,{name:"viewport",content:"width=device-width initial-scale=1 minimum-scale=1 maximum-scale=1 user-scalable=0"});if(z.platform.name==="iphone"){a("META",i,{name:"apple-mobile-web-app-capable",content:"yes"})}$(document.body).css("-webkit-text-size-adjust","none")}var P=function(a,b){if(!b){return a}for(var c in b){var d=new RegExp("{"+c+"}","g");var e=b[c];a=a.replace(d,e)}return a}}var h=function(){function a(){if(/http:\/\/.+\.(loc)\.flyapps\.me\//.test(location.href)||/http:\/\/loc\.flyapps\.me\//.test(location.href)||/http:\/\/.+test\.flyapps\.me\//.test(location.href)){return s.DEBUG}else if(/http:\/\/.+\.(stg|test)\.flyapps\.me\//.test(location.href)){return s.INFO}else if(/http:\/\/.+\.flyapps\.me\//.test(location.href)){return s.ERROR}return s.DEBUG}function c(){var a=b()["doatloggeroutput"];if(a){switch(a){case"console":return s.consoleLogger;break;case"inline":return s.writeLogger;break;case"alert":return s.alertLogger;break;case"popup":return s.popupLogger;break;default:if(window[a]){return window[a]}}}return s.consoleLogger}return new s(a(),c())};var m=function(a,b){var c;for(c in b){if(typeof a[c]=="undefined"){return false}}for(c in b){if(b[c]){switch(typeof b[c]){case"object":if(!b[c].equals(a[c])){return false}break;case"function":if(typeof a[c]=="undefined"||c!="equals"&&b[c].toString()!=a[c].toString())return false;break;default:if(b[c]!=a[c]){return false}}}else{if(a[c])return false}}for(c in a){if(typeof b[c]=="undefined"){return false}}return true};s.prototype.debug=function(){if(this.getLevel()<=s.DEBUG){this._log("DEBUG",this,arguments)}};s.prototype.info=function(){if(this.getLevel()<=s.INFO){this._log("INFO",this,arguments)}};s.prototype.warn=function(){if(this.getLevel()<=s.WARN){this._log("WARN",this,arguments)}};s.prototype.error=function(){if(this.getLevel()<=s.ERROR){this._log("ERROR",this,arguments)}};s.prototype.fatal=function(){if(this.getLevel()<=s.FATAL){this._log("FATAL",this,arguments)}};s.prototype._log=function(a,b,c){var d=new Date;var e="";e+=d.getHours()<10?"0"+d.getHours():d.getHours();e+=":"+(d.getMinutes()<10?"0"+d.getMinutes():d.getMinutes());e+=":"+(d.getSeconds()<10?"0"+d.getSeconds():d.getSeconds());e+="."+(d.getMilliseconds()<100?d.getMilliseconds()<10?"00"+d.getMilliseconds():"0"+d.getMilliseconds():d.getMilliseconds());var f=[],g="("+e+")";if(this._isMobileBrowser){var h=g+" ";for(var i=0,j=c.length;i<j;i++){h+=" "+c[i]}f=[h]}else{f=["("+e+")"];for(i in c){f.push(c[i])}}this.getLogger()(a,b,f)};s.DEBUG=1;s.INFO=2;s.WARN=3;s.ERROR=4;s.FATAL=5;s.NONE=6;s.alertLogger=function(a,b,c){alert(a+" - "+c.join(" "))};s.writeLogger=function(a,b,c){var d=document.createElement("li");d.innerHTML=a+" : "+c.join(" ");var e=loggerList.getElementsByTagName("li")[0];loggerList.insertBefore(d,e)};s.consoleLogger=function(a,b,c){if(window.console){try{window.console[a.toLowerCase()].apply(window.console,c)}catch(d){try{window.console[a.toLowerCase()](c)}catch(d){window.console.log(a+":"+c)}}}};s.popupLogger=function(a,b,c){var d=c.join(" ");if(b.popupBlocker){return}if(!b._window||!b._window.document){b._window=window.open("","logger_popup_window","width=420,height=320,scrollbars=1,status=0,toolbars=0,resizable=1");if(!b._window){b.popupBlocker=true;alert("You have a popup window manager blocking the log4js log popup display.\n\nThis must be disabled to properly see logged events.");return}if(!b._window.document.getElementById("loggerTable")){b._window.document.writeln("<table width='100%' id='loggerTable'><tr><th align='left'>Level</th><th width='100%' colspan='2' align='left'>Message</th></tr></table>");b._window.document.close()}}var e=b._window.document.getElementById("loggerTable");var f=e.insertRow(-1);var g=f.insertCell(-1);var h=f.insertCell(-1);g.style.fontSize="8pt";h.style.fontSize="8pt";h.style.whiteSpace="nowrap";h.style.width="100%";if(e.rows.length%2==0){g.style.backgroundColor="#eeeeee";h.style.backgroundColor="#eeeeee"}g.innerHTML=a;h.innerHTML=d};s.dumpObject=function(a,b){if(!b){b=""}if(b.length>20){return}var c="{\n";for(var d in a){c+=b+d+":";var e=typeof a[d];e=e.toLowerCase();if(e=="object"){c+=s.dumpObject(a[d],b+"----")}else{c+=a[d]}c+="\n"}c+=b+"}";return c};s.isMobileBrowser=function(a){!a&&(a=navigator.userAgent);a=a.toLowerCase();var b=/(iphone|ipad|android|symbian|webos|windows phone os)/.exec(a)||[];return b[1]};var t=function(){var a=this,b=navigator,c="everything",d="extractor",e="extractor_config",f="sites",g;this.init=function(){var a=window[e]=window[e]||{};g=a[f]=a[f]||[]};this.set=function(a){!(a instanceof Array)&&(a=[a]);for(var b=0;b<a.length;b++){g.push(a[b])}};this.getItems=function(){var a=b[c][d].getItems?b[c][d].getItems():"NOT IMPLEMENTED";return a};a.init()};(function(){function g(a){var b="select * from geo.places where woeid in ("+"select place.woeid from flickr.places where lat="+a.coords.latitude+" and  lon="+a.coords.longitude+")";i(b);c=a}function i(a,b){if(document.getElementById("doatenvlocationdata")){var c=document.getElementById("doatenvlocationdata");c.parentNode.removeChild(c)}var e=b?b+"?":"http://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(a)+"&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";e+="&format=json&callback="+d;var f=document.getElementsByTagName("head")[0];var g=document.createElement("script");g.setAttribute("id","doatenvlocationdata");g.setAttribute("src",e);f.appendChild(g)}function j(a){var b={};if(a){if(a.latitude&&a.longitude){a.lat=a.latitude;a.lon=a.longitude}if(a.lat&&a.lon){b.position={coords:{latitude:a.lat,longitude:a.lon}}}if(a.query){if(a.query.results&&a.query.results.place){var d=a.query.results.place;b["city"]=d.locality1&&d.locality1.content;b["country"]=d.country&&d.country.content;b["zip"]=d.postal&&d.postal.content}}else if(a.country_name){b["city"]=a.city;b["country"]=a.country_name}else{e(b,a)}}if(!b.position&&c){b["position"]=c;c=undefined}return b}var a,c,d="doat_onLocationRetrieved_"+(new Date).getTime(),f=typeof M!="undefined"&&M&&M.Log||new h;w.prototype.getLocation=function(c,d){a=c;if(!d||!d.testProps){if(d&&d.request){f.info("Specific params requested for location",d.request);var e=b(),h={},k=false,l=false,m=d.request.constructor===String?[d.request]:d.request;for(var n=0;n<m.length;n++){var o="do_loc_"+m[n];if(e[o]){h[m[n]]=decodeURIComponent(e[o]);f.info("found "+o);l=true}else{f.info("could not find "+m[n]+" in querystring");k=true;if(!d.allowOneFound){break}}}if(!k||d.allowOneFound&&l){f.info("found required location data in querystring");a(j(h));return true}else{f.info("Couldnt find required location data in querystring")}}if(this.isMobile()){navigator.geolocation.getCurrentPosition(function(a){g(a)},function(b){a(b)})}else{i(null,"http://geoip.pidgets.com/")}}else if(d&&d.testProps&&d.testProps["position"]){g(d.testProps["position"])}};window[d]=function(b){b=j(b);a(b)}})();var x=function(){var a=this,b={};this.addEventListener=function(a,d){var e=b[a];if(!e){b[a]={callbacks:[],enabled:false};e=b[a]}e["callbacks"].push(d);if(e["enabled"]&&e["callOnce"]){c(d)}};this.dispatchEvent=function(a,d){var f=b[a];if(!f){b[a]={callbacks:[],enabled:true};f=b[a]}else{var g=f["callbacks"].length;for(var h=0;h<g;++h){c(f["callbacks"][h])}}if(d){e(f,d)}};var c=function(a){a()};this.ready=function(b){a.addEventListener("ready",b)};this.focused=function(b){a.addEventListener("focused",b)};this.blurred=function(b){a.addEventListener("blurred",b)};this.hidden=function(b){a.addEventListener("hidden",b)};this.visible=function(b){a.addEventListener("visible",b)};this.NO_RESULTS="no results";this.RENDER_START="render start";this.RENDER_END="render end";this.RENDER_VISIBLE_END="render visible end";this.SEARCH_START="search request";this.SEARCH_END="search response success";this.SEARCH_ERROR="search response error";this.WINDOW_LOADED="window loaded";this.DOAT_READY="doat ready";this.DOCUMENT_READY="document ready";this.USER_ACTION="user action";this.PAGE_VIEW="page view";this.ready(function(){b["ready"].enabled=true});this.focused(function(){b["focused"].enabled=true;b["visible"].enabled=b["hidden"].enabled=b["blurred"].enabled=false});this.visible(function(){b["visible"].enabled=true;b["focused"].enabled=b["hidden"].enabled=b["blurred"].enabled=false});this.hidden(function(){b["hidden"].enabled=true;b["focused"].enabled=b["visible"].enabled=b["blurred"].enabled=false});this.blurred(function(){b["blurred"].enabled=true;b["focused"].enabled=b["visible"].enabled=b["hidden"].enabled=false})};(function(a,b,c){function H(a,b){var c=~~((a[e]-1)/2);for(var d=1;d<=c;d++){b(a[d*2-1],a[d*2])}}function I(a){var c=b.createElement(a||"div");H(arguments,function(a,b){c[a]=b});return c}function J(a,b,c){if(c&&!c[t])J(a,c);a.insertBefore(b,c||null);return a}function L(a,b){var c=[j,b,~~(a*100)].join("-"),d="{"+j+":"+a+"}",f;if(!F[c]){for(f=0;f<E[e];f++){try{K.insertRule("@"+(E[f]&&"-"+E[f].toLowerCase()+"-"||"")+"keyframes "+c+"{0%{"+j+":1}"+b+"%"+d+"to"+d+"}",K.cssRules[e])}catch(g){}}F[c]=1}return c}function M(a,b){var d=a[m],f,g;if(d[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(g=0;g<E[e];g++){f=E[g]+b;if(d[f]!==c)return f}}function N(a){H(arguments,function(b,c){a[m][M(a,b)||b]=c});return a}function O(a){H(arguments,function(b,d){if(a[b]===c)a[b]=d});return a}var d="width",e="length",f="radius",g="lines",h="trail",i="color",j="opacity",k="speed",l="shadow",m="style",n="height",o="left",p="top",q="px",r="childNodes",s="firstChild",t="parentNode",u="position",v="relative",w="absolute",x="animation",y="transform",z="Origin",A="Timeout",B="coord",C="#000",D=m+"Sheets",E="webkit0Moz0ms0O".split(0),F={},G;J(b.getElementsByTagName("head")[0],I(m));var K=b[D][b[D][e]-1];var P=function(b){this.opts=O(b||{},g,12,h,100,e,7,d,5,f,10,i,C,j,1/4,k,1)},Q=P.prototype={spin:function(b){var c=this,d=c.el=c[g](c.opts);if(b){J(b,N(d,o,~~(b.offsetWidth/2)+q,p,~~(b.offsetHeight/2)+q),b[s])}if(!G){var e=c.opts,f=0,i=20/e[k],l=(1-e[j])/(i*e[h]/100),m=i/e[g];(function n(){f++;for(var b=e[g];b;b--){var h=Math.max(1-(f+b*m)%i*l,e[j]);c[j](d,e[g]-b,h,e)}c[A]=c.el&&a["set"+A](n,50)})()}return c},stop:function(){var b=this,d=b.el;a["clear"+A](b[A]);if(d&&d[t])d[t].removeChild(d);b.el=c;return b}};Q[g]=function(a){function s(b,c){return N(I(),u,w,d,a[e]+a[d]+q,n,a[d]+q,"background",b,"boxShadow",c,y+z,o,y,"rotate("+~~(360/a[g]*m)+"deg) translate("+a[f]+q+",0)","borderRadius","100em")}var b=N(I(),u,v),c=L(a[j],a[h]),m=0,r;for(;m<a[g];m++){r=N(I(),u,w,p,1+~(a[d]/2)+q,y,"translate3d(0,0,0)",x,c+" "+1/a[k]+"s linear infinite "+(1/a[g]/a[k]*m-1/a[k])+"s");if(a[l])J(r,N(s(C,"0 0 4px "+C),p,2+q));J(b,J(r,s(a[i],"0 0 1px rgba(0,0,0,.1)")))}return b};Q[j]=function(a,b,c){a[r][b][m][j]=c};var R="behavior",S="url(#default#VML)",T="group0roundrect0fill0stroke".split(0);(function(){var a=N(I(T[0]),R,S),b;if(!M(a,y)&&a.adj){for(b=0;b<T[e];b++){K.addRule(T[b],R+":"+S)}Q[g]=function(){function h(){return N(I(T[0],B+"size",c+" "+c,B+z,-b+" "+ -b),d,c,n,c)}function s(c,e,l){J(k,J(N(h(),"rotation",360/a[g]*c+"deg",o,~~e),J(N(I(T[1],"arcsize",1),d,b,n,a[d],o,a[f],p,-a[d]/2,"filter",l),I(T[2],i,a[i],j,a[j]),I(T[3],j,0))))}var a=this.opts,b=a[e]+a[d],c=2*b;var k=h(),m=~(a[e]+a[f]+a[d])+q,r;if(a[l]){for(r=1;r<=a[g];r++){s(r,-2,"progid:DXImage"+y+".Microsoft.Blur(pixel"+f+"=2,make"+l+"=1,"+l+j+"=.3)")}}for(r=1;r<=a[g];r++){s(r)}return J(N(I(),"margin",m+" 0 0 "+m,u,v),k)};Q[j]=function(a,b,c,d){d=d[l]&&d[g]||0;a[s][r][b+d][s][s][j]=c}}else{G=M(a,x)}})();a.Spinner=P})(window,document);var y=function(){var a=M,c="tml_",d=a.Env.isMobile(),f,g,h,i={},j={},k,l=true,n=false,o,p,q=[],r=false,s,t,u;var v=a.Env.getInfo().browser.name||a.Env.getInfo().browser;k=v==="webkit"?"-webkit-":v==="mozilla"?"-moz-":"";var w=function(a){a&&(i=e(i,a));var b=document.querySelector(".tml_content");o=i.firstPageId||b&&b.id};var x=function(){var a=arguments;var b=typeof a[0]==="string"?a[0]:a[0].get?a[0].get(0).getAttribute("id"):a[0].getAttribute("id"),c=a[1],d=typeof a[2]==="string"?a[2].toLowerCase():"oncomplete",e=typeof a[2]==="string"?a[3]:a[2];j[b]=j[b]||{};j[b][d]=j[b][d]||{};j[b][d][c]=e};var y=function(b,e,g){!e&&(e=R().urlParams);if(!b||n){return false}n=true;var h=b.constructor===String?$("#"+b):$(b);if(h.hasClass(c+"drawer")){e||(e={});e["transition"]="drawer"}else{if(!h.hasClass(c+"content")){M.Log.error("."+c+"content classname expected.");return}}if(!g){E(h,e)}if(f[0].id==h[0].id&&f.css("display")=="block"){F(h,e);return false}var j=false;if(u){j=u.out(h);u=null}if(!j){if(e&&e["transition"]=="none"){var l={left:"0%",display:"block"};l[k+"transition-duration"]="0";l[k+"transform"]="translateX(0)";h.css(l);var m={display:"none"};if("outElementStyle"in e){for(var o in e["outElementStyle"]){m[o]=e["outElementStyle"][o]}}f.css(m);F(h,e)}else if(e&&e["transition"]=="fade"){f.css("z-index",2);if(d){h.css(k+"transition-duration","0");h.css(k+"transform","translateX(0)")}else{h.css("left",0)}h.css("display","block");f.css(k+"transition","opacity 0.5s linear").css("opacity",0);setTimeout(function(){f.css("display","none").css(k+"transition-duration","0").css({"z-index":1,opacity:1});F(h,e)},200)}else if(e&&e["transition"]=="drawer"){M.Transitions["drawer"].in({cssPrefix:k,config:i,current:f,next:h,onComplete:function(a){F(a,e)}});u=M.Transitions["drawer"]}else{var p=e&&e.direction||H(h),q=p==="rtl"?"100%":"-100%",r=p==="rtl"?"-100%":"100%";if(d){h.css(k+"transition-duration","0");h.css(k+"transform","translateX("+q+")")}else{h.css("left",q)}h.css("display","block");setTimeout(function(){h.animate({left:"0%"});f.animate({left:r},200,"ease",function(){F(h,e)})},200)}}if(!e||e.muteEventReport!==true){var s={action:"Navigate",to:h[0].id};if(e&&e.title){s.title=e.title.replace("/","-")}if(e&&e.id&&e.id.replace){s.id=e.id.replace("/","-")}if(a.Messenger){a.Messenger.trigger(a.Events.USER_ACTION,s)}}M.Viewport.hideAddressBar();return true};var A=function(){if(t){var a=R().firstPage;if(a){B(o,{direction:"ltr"})}else{history.back()}}else{B(g,{muteEventReport:true})}M.Viewport.hideAddressBar()};var B=function(a,b,c){!b&&(b={});if(t){a.constructor!==String&&(a=$(a)[0].id);var d=R().urlParams;if(b.url){for(var f in b.url){d[f]=b.url[f]}delete b.url}d["topage"]=a;if(m(d,Q())){return false}var g=[];for(var f in d){if(!(f==="topage"&&d[f]===o)){var h=d[f]!==undefined?d[f]:"";g.push(f+"="+h)}}var i="?"+g.join("&");e(b,{firstPage:false,urlParams:d});window.history.pushState(b,null,i)}y.apply(this,arguments)};var C=function(a,b){var c=f.next();if(c&&c.hasClass("tml_content")){B(c,a,b)}};var D=function(a,b){var c=f.prev();if(c&&c.hasClass("tml_content")){B(c,a,b)}};var E=function(a,b){var c=f[0].id,d=a[0].id;e(b,{currentElement:f[0],nextElement:a[0]});G(b,["*","onstart","in"]);G(b,[d,"onstart","in"]);if(c!=d){G(b,[c,"onstart","out"])}G(b,b,["onStart"])};var F=function(a,b){var d=f[0].id,h=a[0].id;g=f;f=a;e(b,{currentElement:f[0],nextElement:g[0]});G(b,["*","oncomplete","in"]);G(b,[h,"oncomplete","in"]);if(d!=h){if(!f.hasClass(c+"drawer")){g.css("display","none")}G(b,[d,"oncomplete","out"])}G(b,b,["onComplete"]);n=false};var G=function(a,b,c){var d=true;if(!c){c=b;b=j}if(!b){return false}for(var e=0,f=c.length;e<f;e++){b=b[c[e]];if(!b){d=false;break}}d&&b(a)};var H=function(a){var b=I(a);var c=b&&b!==""&&b!=="none"?b==="translateX(-100%)":a.get(0).style.left==="-100%";return c?"ltr":"rtl"};var I=function(a){var b=a.css(k+"transform"),c=a[0].style[k+"transform"];return b&&b!==""&&b!=="none"?b:c};var J=function(a){if(a.constructor===String){f=$("#"+a)}else{f=$(a)}!o&&(o=a.id)};var K=function(){return f[0]};var L=function(){if(f&&h!==f[0].offsetHeight){h=f[0].offsetHeight;return h}return false};var N=function(a){if(a&&a.state){var b=S(a);var c=b.urlParams.topage||o;y(c,b)}};var O=function(){var a=Q(),b=a["topage"]||o,c={transition:"none",outElementStyle:{}};if(M.Env.isMobile()){c["outElementStyle"][k+"transform"]="translateX(-100%)"}else{c["outElementStyle"]["left"]="-100%"}var d=R();if(!d||d.firstPage===undefined){d={firstPage:true,urlParams:a};S({state:d});window.history.replaceState(d,null)}e(c,{firstPage:true,urlParams:a});y(b,c)};var P=function(){t=true;window.addEventListener("popstate",N,false);O()};var Q=function(){var a=b();for(var c in a){a[c]=decodeURIComponent(a[c])}return a};var R=function(){var a={};if(s){for(var b in s){a[b]=s[b]}}return a};var S=function(a){return s=a&&a.state};return{init:w,initHistory:P,goTo:B,next:C,previous:D,back:A,attachCallback:x,bind:x,setCurrent:J,getCurrent:K,hasNewContentHeight:L,Indicator:new z,getCurrentHistoryState:R}};var A={drawer:function(){var a,b,c,d,e,f={moveBy:"80%",underlay:true,position:"left"};return{"in":function(g){e=g.cssPrefix;var h=g.config,i=g.current,j=g.next;d=f;if(typeof h["drawer"]!=="undefined"){$.extend(d,h["drawer"])}j.css(e+"transition","none");j.css(e+"transform","translateX(-100%)");j.css({width:d.moveBy});j.animate({left:"0%"});i.animate({left:d.moveBy});a=j;b=i;c=g.onComplete;setTimeout(function(){c(j)},400)},out:function(f){f.css(e+"transition","none");f.css(e+"transform","translateX("+d.moveBy+")");f.css({display:"block"});if(f.attr("id")!==b.attr("id")){b.css(e+"transition","none");b.css(e+"transform","translateX(100%)")}setTimeout(function(){f.css(e+"transition","all 0.2s");f.animate({left:"0px"});a.animate({left:"-100%"});setTimeout(function(){c(f);$next=null;b=null;c=null;d=null},400)},0);return true}}}()};var B=function(a){function l(){c=document.getElementById("tml-searchbar-searchfield");if(c){e=$(document.body);f=document.getElementById("tml-searchbar-form");b.submit=f.onsubmit;j=c.getAttribute("data-defaulttext");c.addEventListener("focus",y,false);c.addEventListener("blur",z,false);c.addEventListener("touchstart",function(){M.Viewport.hideAddressBar()},false);if(a&&a.searchClearButton){m(a)}u("");M.Nav.bind("*","in","onstart",function(a){if(!a||!a.urlParams){return}var b=a.urlParams.do_query||"";u(b)})}}function m(a){if(w().getAttribute("data-clearbutton")!==""){d=new C;var b=a&&a.css||{};!b["left"]&&(b["left"]=c.offsetWidth);buttonEl=d.init({css:b,onClick:function(){u("",true);q()}});var e=w().parentNode;e.style.position="relative";e.appendChild(buttonEl)}}function n(){c.className="";if(!j){return}if(v()===j){u("",true)}}function o(){if(!j){return}if(v()===""){u(j)}}function p(a){M.Viewport.hideAddressBar();if(v()!==""&&v()!==j){a&&a()}r()}function q(){c.focus()}function r(){c.blur()}function s(a){g.push(a)}function t(a){h.push(a)}function u(a,b){if(!b&&!a){a=j||""}if(j){c.className=k}c.value=A(a)}function v(){return A(c.value)}function w(){return c}function x(){M.Messenger.trigger(M.Events.USER_ACTION,{action:"Search",newQuery:v()});r()}function y(){M.Viewport.hideAddressBar();e.addClass(i);n();for(var a=0,b=g.length;a<b;a++){g[a].call(c)}}function z(){e.removeClass(i);o();for(var a=0,b=h.length;a<b;a++){h[a].call(c)}}function A(a){return a.replace(/\+/g," ")}var b=this,c,d,e,f,g=[],h=[],i="tml-searchbar-keyboard-visible",j,k="default";this.clearValue=n;this.fillValue=o;this.setValue=u;this.getInputElement=w;this.submitFunc=p;this.blur=r;this.focus=q;this.onKeyboardVisible=s;this.onKeyboardHidden=t;M.Events.ready(l);this.getValue=function(){var a=v();return a!==j?a:""}};var D=function(){function t(){var a;this.init=function(b){a=$('<div class="handle_wrapper"><div class="handle"/></div>');return a};this.update=function(a){b(a)};this.onTouchMove=function(){a.addClass("dragged")};this.onTouchEnd=function(){a.removeClass("dragged")};var b=function(b){a.css(c+"transform","translateX("+b+"px)")}}function u(){var a=this;var b,c,d,e;this.init=function(f){e=f;b=$('<div class="preview"/>');c=$('<div class="content"/>');b.append(c);d=$('<span class="indicator"/>');b.append(d);a.hide();return b};this.show=function(){b.addClass("displayed")};this.update=function(a){c.html(e[a]);d.html(a+1+" of "+e.length)};this.hide=function(){b.removeClass("displayed")}}var a,b,c,d,e,f,g,h,i,j,k,l,m;this.init=function(d){var e;if(d&&d.id&&document.getElementById(d.id)){e=$("#"+d.id)}else{return false}if(typeof M!=="undefined"){b=M.Env.isMobile();var k=M.Env.getInfo().browser;c=k==="webkit"?"-webkit-":k==="mozilla"?"-moz-":""}else{b=true}j=d.trackWidth;m=d.onSelect;g=b?"touchstart":"mousedown";h=b?"touchmove":"mousemove";i=b?"touchend":"mouseup";a=$('<div class="doml-slider" />');e.parent().append(a);a.append(e);var o=[];e.children().each(function(){var a=$("<div/>");$(this).appendTo(a);o.push(a.html())});itemArrLength=o.length;l=j/itemArrLength;var q=$('<div class="wrapper">');q.css("width",j+"px");a.append(q);$eventCaptureEl=$('<div class="eventCapture" />');$eventCaptureEl.css("width",j+"px");$eventCaptureEl.bind(g,n,false);document.addEventListener(i,p,false);q.append($eventCaptureEl);handleWrapper=new t;var r=handleWrapper.init();q.append(r);f=new u;var s=f.init(o);r.append(s);return true};var n=function(a){document.addEventListener(h,o,false);var b=r(a);var c=q(b);if(c!==k){k=c;f.update(k)}handleWrapper.update(b,k);f.show()};var o=function(a){a.preventDefault(a);var b=r(a);if(b<=j&&b>=0){var c=q(b);if(c!==k){k=c;f.update(k)}handleWrapper.onTouchMove();handleWrapper.update(b,k)}};var p=function(a){handleWrapper.onTouchEnd();document.removeEventListener(h,o);var b=s(k);handleWrapper.update(b);f.hide();if(m)m(k)};var q=function(a){var b=a/j*itemArrLength;b=parseInt(b,10);return b};var r=function(a){a=a.touches&&a.touches[0]||a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]||a;return a.clientX};var s=function(a){return a*l}};var I=function(){function z(){if(J.get(s)!=v){$(document.body).addClass("loggedout");h.find(".button-loading").removeClass("active");h.find(".button-real").addClass("active");g&&g.show();f.show();var a=document.body.scrollTop||document.documentElement.scrollTop;var b=window.innerHeight/2+a;f.css({top:b+"px","margin-top":-(f.height()/2+20)+"px"});f.bind("touchstart",function(a){a.preventDefault()});if(Spinner){var c={lines:8,length:2,width:3,radius:3,color:"#fff",speed:1,trail:60,shadow:false};loading=(new Spinner(c)).spin(j.find(".icon")[0])}}}function A(){var a=$('<div id="fb-root"></div>');e.append(a);var b=document,c,d="facebook-jssdk",f=b.getElementsByTagName("script")[0];c=b.createElement("script");c.id=d;c.async=true;c.src="//connect.facebook.net/en_US/all.js";f.parentNode.insertBefore(c,f)}function B(){function d(d,e){b&&b.abort();b=$.getJSON("http://developer."+c+"/facebook/updateToken.php?token="+a+"&data="+encodeURIComponent(JSON.stringify(d))+"&callback=?",function(a){e&&e(a)})}var a="",b=null,c="flyapps.me";this.init=function(b){var d=window.location.host.split(".");if(!b){b=d[0]}d.splice(0,1);c=d.join(".");a=b+"-"+(new Date).getTime()};this.addToLink=function(b){if(b){if(b.indexOf("?")!==-1){b+="&token="+a}else{b+="?token="+a}return b}return false};this.handleAPICallback=function(a,b){if(!b||b.error){a.fb.onError&&a.fb.onError()}else{a.app.onSuccessInit&&a.app.onSuccessInit();var c=null;var e=null;if(b){e=b.post_id}var f={app:{id:a.app.app_id,name:a.app.app_name,link:a.app.app_link||a.fb.link,image:a.app.app_image||null},fb:a.fb,post:{profile_id:null,profile_name:null,profile_image:null,message:null,created:null}};M.FB.getUser(function(b){a.app.getUser&&a.app.getUser(b);f.post.profile_id=b.id;f.post.profile_name=b.name;f.post.profile_image="http://graph.facebook.com/"+b.id+"/picture";if(e){d(f);M.FB.getPostData(e,function(b){a.app.onGetPostData&&a.app.onGetPostData(b);if(b.picture){f.app.image=decodeURIComponent(b.picture.match(/&src=(.+)/)[1])}if(b.message){f.post.message=b.message}if(b.created){f.post.created=b.created}d(f,function(){a.fb.onSuccess&&a.fb.onSuccess()})},function(){a.fb.onSuccess&&a.fb.onSuccess()})}else{d(f,function(){a.fb.onSuccess&&a.fb.onSuccess()})}})}}}function C(a,b,c){o=a;if(!a||a.error){c&&c(a)}else{b&&b(a)}}function D(){return J.get(s)}function E(a,b,c){if(!a){b&&b();return}var d="select "+a+" from permissions where uid=me()";var e=FB.Data.query(d);e.wait(function(d){var e=true;var f=new Array;f=a.split(",");$.each(f,function(a,b){if(d[0][b]!=1){e=false;return}});if(e){b&&b()}else{c&&c()}})}function F(){J.set(s,v);e.addClass(x);b.hideLogin();for(var a=0;a<p.length;a++){p[a]()}}function G(){}function H(){var b="#doat-fb-login {"+"position: absolute;"+"left: 50%;"+"width: 260px;"+"margin: 0 0 0 -150px;"+"background: rgba(0, 0, 0, .8);"+"padding: 20px;"+"border-radius: 10px;"+"color: #fff;"+"text-shadow: 0 1px 3px rgba(0, 0, 0, .3);"+"text-align: center;"+"font-size: 18px;"+"z-index: 600;"+"display: none;"+"}"+"#doat-fb-login .button {"+"position: relative;"+"font-weight: bold;"+"margin-top: 20px;"+"height: 44px;"+"line-height: 44px;"+"font-size: 17px;"+"border: 1px solid #2e4687;"+"text-shadow: 0 1px 0 rgba(0, 0, 0, .5);"+"cursor: pointer;"+"-moz-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;"+"-webkit-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;"+"-ms-box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;"+"box-shadow: 0 1px 0 0 #8d9fc8 inset, 0 2px 0 0 #6880b6 inset;"+"background: #485f9a;"+"background: -moz-linear-gradient(center top, #5670ad 0, #3c4e88 100%);"+"background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #5670ad), color-stop(1, #3c4e88));"+"border-radius: 5px;"+"}"+"#doat-fb-login .button .c {"+"position: absolute;"+"top: 0;"+"bottom: 0;"+"left: 0;"+"right: 0;"+"padding-left: 45px;"+"opacity: 0;"+"pointer-events: none;"+"-moz-transition: all .3s linear;"+"-webkit-transition: all .3s linear;"+"-ms-transition: all .3s linear;"+"transition: all .3s linear;"+"}"+"#doat-fb-login .button .c.active {"+"opacity: 1;"+"pointer-events: auto;"+"}"+"#doat-fb-login .button .button-loading .text {"+"opacity: .5;"+"}"+"#doat-fb-login .button .icon {"+"position: absolute;"+"top: 0;"+"bottom: 0;"+"left: 0;"+"width: 45px;"+"border-right: 1px solid #2e4687;"+"-moz-box-shadow: -1px 1px 0 0 #8d9fc8 inset;"+"-webkit-box-shadow: -1px 1px 0 0 #8d9fc8 inset;"+"-ms-box-shadow: -1px 1px 0 0 #8d9fc8 inset;"+"box-shadow: -1px 1px 0 0 #8d9fc8 inset;"+"border-radius: 5px 0 0 5px;"+"}"+"#doat-fb-login .button .button-real .icon:before {"+'content: "";'+"position: absolute;"+"top: 50%;"+"left: 50%;"+"width: 32px;"+"height: 32px;"+"margin: -15px 0 0 -16px;"+"background-image:url(http://cdn0.flyapps.me/developer/facebook/fb.png);"+"background-size: 31px 32px"+"}"+"#doat-fb-login-cancel {"+"color: #ccc;"+"cursor: pointer;"+"font-size: 15px;"+"margin-top: 20px;"+"display: none;"+"}"+"#doat-fb-login-cancel span {"+"text-decoration: underline;"+"}"+"#doat-fb-overlay {"+"position: absolute;"+"height: 1000px;"+"top: 0;"+"left: 0;"+"right: 0;"+"bottom: 0;"+"background: rgba(0,0,0,.5);"+"z-index: 500;"+"display: none;"+"}";a("style",d,{innerHTML:b})}function I(){var a=document.createElement("div");a.id="doat-fb-login";a.innerHTML='<div class="content"></div>'+'<div class="button">'+'<div class="c button-loading">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</div>"+'<div class="c button-real">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</div>"+"</div>"+'<div class="cancel" id="doat-fb-login-cancel"></div>';document.body.appendChild(a)}var b=this,c={},d=document.getElementsByTagName("head")[0],e=$(document.body),f=null,g=null,h=null,i=null,j=null,k=false,l=textConnect=textConnecting=null,m=null;var n=false,o=null,p=[];var q=null,r=null,s="isFBUser",t="",u=1,v=2,w="doml-facebook",x="doml-facebook-loggedin";var y={textDialog:"Welcome<br />Please login",textConnect:"Login with Facebook",textConnecting:"Connecting..."};this.init=function(a,d){a&&(c=a);if(n||!d&&!c.login&&!D()){return}q=c.appId;r=c.channel||"http://"+window.location.hostname+"/channel.php";l=c.textDialog||y.textDialog;textConnect=c.textConnect||y.textConnect;textConnecting=c.textConnecting||y.textConnecting;t=c.namespace||"";H();I();$elLoginCancel=$("#doat-fb-login-cancel");f=$("#doat-fb-login");h=f.find(".button");j=h.find(".button-loading");i=h.find(".button-real");f.find(".content").html(l);i.find(".text").html(textConnect);j.find(".text").html(textConnecting);h.bind("touchstart",function(a){a.preventDefault();a.stopPropagation();b.login()});g=$('<div id="doat-fb-overlay"></div>');e.append(g);g.bind("touchstart",function(a){a.preventDefault();a.stopPropagation()});e.addClass(w);if(c.permissions){m=c.permissions}z();A();n=true};this.forceInit=function(){b.init(null,true)};this.onFBInit=function(){FB.init({appId:q,channelUrl:r,status:true,cookie:true,xfbml:false});FB.getLoginStatus(function(a){k=a.status==="connected";if(a.status==="connected"){E(m,F,function(){b.login()})}else{b.showLogin()}})};window.fbAsyncInit=b.onFBInit;this.showLogin=function(){J.set(s,u);z();FB.Event.subscribe("auth.statusChange",function(a){k=a.status==="connected";if(k){F()}else{G()}})};this.hideLogin=function(){f.hide();g&&g.hide();$(document.body).removeClass("loggedout");k=true};this.login=function(){if(!n){b.forceInit();return}if(!J.get(s)){J.set(s,u)}FB.login(function(a){if(a.status!=="connected"){G()}else{F()}},m?{scope:m}:null)};this.logout=function(){};this.loggedIn=function(){return k};this.action=function(a){var b=a.fb.namespace||t;var c=null;var d=new B;d.init(a.fb.shortname);for(key in a.fb.data){a.fb.data[key]=d.addToLink(a.fb.data[key])}FB.api("/me/"+b+":"+a.fb.action,"post",a.fb.data,function(b){d.handleAPICallback(a,b)})};this.share=function(a){if(!a||!a.fb||!a.app)return;if(!n){b.onLogin(function(){b.share(a)});b.forceInit();return}var c={method:"feed",link:a.fb.link||"http://"+window.location.hostname,message:a.fb.message||null,picture:a.fb.picture||null,name:a.fb.name||null,description:a.fb.description||null,caption:a.fb.caption||null};var d=new B;d.init(a.fb.shortname);c.link=d.addToLink(c.link);FB.ui(c,function(b){d.handleAPICallback(a,b)})};this.getUser=function(a,b){if(o){C(o,a,b)}else{FB.api("/me",function(c){C(c,a,b)})}};this.getPostData=function(a,b,c){if(!a){return null}FB.api(a,"get",function(a){if(!a||a.error){c&&c(a)}else{b&&b(a)}});return true};this.onLogin=function(a){p.push(a)};var J=new function(){this.get=function(a){var b=null;if("localStorage"in window){try{b=localStorage[a]}catch(c){}}return b};this.set=function(a,b){if(!"localStorage"in window){return false}try{localStorage[a]=b}catch(c){return false}return true}}};var J=function(){function m(){return M.Env.getInfo().orientation.name}function n(b,c){if(window.innerHeight>=g[b]){q(window.innerHeight,b,a.DETECTED,c);o(b,window.innerHeight);a.hideAddressBar()}else{setTimeout(function(){n(b,c)},1e3)}}function o(a,b){}function p(){return undefined}function q(a,b,c,f){var g=document.createElement("style");g.id="viewport-"+b;var h="";h+=".orientation-"+b+"{min-height:"+a+"px; position: relative; top: auto; left:auto; bottom: auto; right: auto}";h+=".orientation-"+b+" #viewportTestElement {display: none}";g.innerHTML=h;document.getElementsByTagName("head")[0].appendChild(g);e[b]=true;d=c;var i={};i[b]={height:a};M.Env.setScreen(i);f&&f(c)}var a=this,b="Viewport",c,d,e={},f={portrait:560,landscape:340},g={portrait:416,landscape:250},h,i="viewport-height",j,k=864e5,l=false;this.STORAGE="storage";this.ENV="env";this.DETECTED="detected";this.init=function(a){c=a.$container;logger=a.logger;h=a.Storage;j=p()||{}};this.setHeight=function(b){var d=m();!b&&(b={});if(e[d]){a.hideAddressBar();setTimeout(a.hideAddressBar,1e3);b.callback&&b.callback();return false}if(!j[d]){var f=TouchyJS.Env.getScreen().height;if(f){q(f,d,a.ENV,b.callback);a.hideAddressBar();o(d,f)}else{var g=$('<div id="viewportTestElement" style="height: 2000px; width: 100%;">&#160;</div>');c.append(g);a.hideAddressBar();setTimeout(function(){n(d,b.callback)},2e3)}}else{q(j[d],d,a.STORAGE,b.callback)}return true};this.getHeight=function(){return{value:c.height(),source:d}};this.hideAddressBar=function(){window.setTimeout(function(){window.scrollTo(0,1)},0)};this.shouldRecalculate=function(a){a&&(l=a);return l};this.getTestHeight=function(a){return f[a]}};var K=function(a){function e(){$.extend(c,a)}var b=this,c={resizerUrl:"http://doatresizer.appspot.com/?",url:"",width:0,height:0,encoding:"jpeg",padding:1,color:"#fff",quality:"80",ignoreRetina:false},d=["url","width","height","encoding","padding","color","quality"];e();this.getSource=function(a){var b={};$.extend(b,c,a);if(!b.url){alert("Must provide an image URL.");return}if(!b.width||!b.height){alert("Either image width or image height are not set.");return}if(M.Env.isRetina()&&!b.ignoreRetina){b.width=b.width*2;b.height=b.height*2}var e=b.resizerUrl,f;for(var g=0;g<d.length;g++){f=d[g];if(f==="url"&&typeof b[f]==="object"){for(var h=0;h<b[f].length;h++){e+=f+"="+b[f][h]+"&"}}else{e+=f+"="+b[f]+"&"}}return e};this.getImageTag=function(a){var d={};$.extend(d,c,a);var e=b.getSource(d);var f="";if(M.Env.isRetina()){f='style="width: '+d.width/2+"px; height: "+d.height/2+'px;"'}return'<img src="'+e+'" '+f+">"}};var M=new L;if(!(typeof doat_config!=="undefined"&&doat_config.manualInit==true)){M.init()}window["TouchyJS"]=window["Doat"]=M})()
